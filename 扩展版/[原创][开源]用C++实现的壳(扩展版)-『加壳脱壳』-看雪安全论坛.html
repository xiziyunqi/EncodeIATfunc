<!DOCTYPE html>
<!-- saved from url=(0039)https://bbs.pediy.com/thread-206873.htm -->
<html lang="zh-cn"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	
	

	
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="author" content="XiunoBBS 4.0">
	<meta name="keywords" content="">
	<meta name="description" content="[原创][开源]用C++实现的壳(扩展版)">
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">

	<title>
		[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛	</title>

	<link rel="shortcut icon" href="https://bbs.pediy.com/view/img/favicon.ico">
	<link rel="icon" sizes="32x32" href="https://bbs.pediy.com/view/img/favicon.ico">
	<link rel="Bookmark" href="https://bbs.pediy.com/view/img/favicon.ico">
		<link rel="stylesheet" href="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/bootstrap.min.css">
	
	<link rel="stylesheet" href="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/bootstrap-bbs.css">
	<link rel="stylesheet" href="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/bootstrap-icon.css">
	<link rel="stylesheet" href="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/kanxue.css">
	<style>
		#search_form {
			width: 250px;
			display: inline-block;
			position: relative;
			padding: 0px;
		}
		
		#search_form>input {
			border-radius: 50px;
			width: 250px;
			display: inline-block;
			text-indent: 32px;
			background: #b6c6d2;
			color: #5B8096;
			border: 1px solid #8b969c;
			padding: 2px !important;
			font-size: 12.8px;
			margin-top: 4px;
			outline: 0;
		}
		
		#search_form>input:focus {
			background-color: #d5e4ef;
		}
		
		#search_form>input::-webkit-input-placeholder {
			color: #6a7e8c;
		}
		
		#search_form>input:-moz-placeholder {
			color: #6a7e8c;
		}
		
		#search_form>input::-moz-placeholder {
			color: #6a7e8c;
		}
		
		#search_form>input:-ms-input-placeholder {
			color: #6a7e8c;
		}
		
		#search_form>span.icon-search {
			position: absolute;
			left: 10px;
			top: 4px;
			line-height: 25px;
		}
		@media only screen and (max-width: 780px) {
			.card>.card-body {
				padding: 0.3rem 0.5rem;
			}
			#body {
				padding: 0.5rem 0.5rem;
			}
			.container {
				padding-left: 0;
				padding-right: 0; 
			}
		}
	</style>

	    <link rel="stylesheet" href="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/user_tree.css" type="text/css">
    <link rel="stylesheet" href="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/folder-tree.css" type="text/css">
<style>
/*
box-shadow: 0 0 5px red;
*/
@keyframes xndigest {
	0% { color: red; text-shadow: 0 0 3px #FF8D8D;} 
	20% { color: orange; text-shadow: 0 0 3px #FFE1AD;} 
	40% { color: green; text-shadow: 0 0 3px #B3FFAF;} 
	65% { color: blue; text-shadow: 0 0 3px #AFE4FF;} 
	80% { color: purple; text-shadow: 0 0 3px #FFC9F3;} 
	100% { color: red; text-shadow: 0 0 3px #FF8D8D;} 
}

/*水晶闪烁效果 占内存*/
i.icon-diamond.flash{color: #D53D38;  /*animation: xndigest 5s linear infinite;*/ }

i.icon-digest-1 {  text-shadow: 0 0 3px #AFE4FF; }
i.icon-digest-2 {  text-shadow: 0 0 3px #FFF177; }
i.icon-digest-3 {  text-shadow: 0 0 3px #FF8D8D; }
.icon-digest-1:before { content: "\f219";  color: #5BC0DE;} /* "\f0a5" */
.icon-digest-2:before { content: "\f219";  color: #ECA541;}
.icon-digest-3:before { content: "\f219"; color: #D53D38;}
.icon-digest-3:afteer { content: "精"; color: #D53D38;}
</style><style>
.deleted div.subject > a { text-decoration: line-through; color: grey !important; }
.deleted div.message { text-decoration: line-through; color: grey !important; }
</style><style>
.icon-new { width: 26px; height: 12px; display: inline-block; background: url(view/img/new.gif)}
</style>
<link rel="stylesheet" type="text/css" href="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/syntax.css"><script src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/syntax.js"></script><script src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/ga.js"></script></head>

<body>

	

	<header class="navbar navbar-expand-lg navbar-dark bg-dark" id="header">
	<div class="container mw-100">
		
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#nav_pc" aria-controls="navbar_collapse" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		
		<a class="navbar-brand" href="https://bbs.pediy.com/forum-88.htm" style="font-size: unset;">
			<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/logo.png" width="21" height="20">
							<span class="hidden-lg">『加壳脱壳』</span>
					</a>
		
					<a class="navbar-brand hidden-lg" href="https://bbs.pediy.com/thread-create-88.htm" aria-label="发表主题"><i class="icon-edit icon"></i></a>
				
		<div class="collapse navbar-collapse" id="nav_pc">
			<!-- 左侧：版块 -->
			<ul class="navbar-nav mr-auto">
				
				<li class="nav-item"><a class="nav-link" href="https://www.kanxue.com/">学院</a></li>
				<li class="nav-item"><a class="nav-link" href="https://www.kanxue.com/chm.htm">知识库</a></li>
				<li class="nav-item"><a class="nav-link" href="https://zhuanlan.kanxue.com/">专栏</a></li>
				<li class="nav-item"><a class="nav-link" href="https://ctf.pediy.com/">CTF</a></li>
				<li class="nav-item"><a class="nav-link" href="https://ce.kanxue.com/">众测</a></li>
				<li class="nav-item"><a class="nav-link" href="https://www.kanxue.com/tool.htm">工具</a></li>
				<li class="nav-item"><a class="nav-link" href="https://www.kanxue.com/service.htm">企业服务</a></li>
				<li class="nav-item"><a class="nav-link" href="https://www.kanxue.com/conference.htm" target="_blank">看雪峰会</a></li>
				<li class="nav-item active"><a class="nav-link" href="https://bbs.pediy.com/">论坛</a></li>
			</ul>
			<!-- 右侧：用户 -->
			<ul class="navbar-nav">
				
			

				<!-- 管理员 -->
								<li class="nav-item">
					<a href="https://www.kanxue.com/pm-list-1.htm" class="pm_total_a text-muted m-x-sm nav-link">
					<i class="icon-envelope"></i>
					<span data-toggle="modal" data-target="#myModal"> 短信</span>
					<span class="pm_total" style="display: inline-block; padding: 0px 3px; font-size: 12px; line-height: 20px; color: white; background-color: rgb(245, 126, 66); border-radius: 9px; text-indent: 0px;"></span>
					</a>
				</li>
				<li class="nav-item m-l-xs xn-toggle pointer" data-target="#toggle_user_new">
					<a class="nav-link px-0"><img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/avatar.png" class="avatar-1"></a>
				</li>
				<li class="nav-item xn-toggle pointer px-0 ml-0" data-target="#toggle_user_new">
					<a class="nav-link px-0">&nbsp;xiziyunqi <i class="icon-caret-down" aria-hidden="true"></i></a>
				</li>

				<div class="text-center" id="toggle_user_new">
					<div class="row m-0 mt-3 align-items-center">
						<div class="col">
							<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/avatar.png" class="avatar-4 mb-0">
							<br>
							<span>xiziyunqi</span>
						</div>
					</div>
					<hr class="my-3">
					<div class="row mx-0 mb-3">
						<div class="col">
							<a href="https://bbs.pediy.com/user-749004.htm" class="text-muted"><i class="icon-user"></i> 我的主页</a>
						</div>
						<div class="col">
							<a href="https://passport.kanxue.com/my.htm" class="text-muted"><i class="icon-cog"></i> 个人设置</a>
						</div>
					</div>
					<div class="row mx-0">
						<div class="col">
							<a href="https://bbs.pediy.com/my-wallet.htm" class="text-muted"><i class="icon-credit-card"></i> 我的钱包</a>
						</div>
						<div class="col">
							<a href="https://www.kanxue.com/pm-list-1.htm" class="pm_total_a text-muted"><i class="icon-envelope"></i><span data-toggle="modal" data-target="#myModal"> 我的短信</span></a>
						</div>
					</div>
					<hr class="my-3">
					<div class="row m-0 mb-3">
						<div class="col-12">
							<a href="https://bbs.pediy.com/user-logout.htm" class="text-muted"><i class="icon-power-off"></i> 退出</a>
						</div>
					</div>
				</div>   
				
			
			</ul>
		</div>
	</div>
</header>
	<div class="hidden-sm hidden-md" style="background:#748692 url(plugin/kanxue/img/header_bg.gif)" id="nav2">
		<div class="container" style="height: 76px;">
			<div class="row">
				<div class="col-lg-6">
					<a href="https://bbs.pediy.com/"><img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/logo_bbs.png" width="359" height="76" class="ml-1"></a>
				</div>
				<div class="col-lg-6 text-right pt-4">
					<form action="https://bbs.pediy.com/search.htm" id="search_form">
						<input type="text" placeholder="关键词 回车搜索" name="keyword">
						<span class="icon-search"></span>
					</form>

				</div>
			</div>
		</div>
	</div>

	<main style="background: #e8ecef url(plugin/kanxue/img/body_bg.jpg) repeat-x" id="body">
		<div class="container">

			

					
		
		<ol class="breadcrumb mb-2 hidden-md-down">
			<li class="breadcrumb-item"><a href="https://bbs.pediy.com/" aria-label="首页"><i class="icon-home"></i> 看雪论坛</a></li>
			<li class="breadcrumb-item"><a href="https://bbs.pediy.com/forum-88.htm">『加壳脱壳』</a></li>
			<!-- <li class="breadcrumb-item active"><a href="thread-206873.htm" title="首页返回主题第一页">[原创][开源]用C++实现的壳(扩展版)</a></li> -->
			

			<div class="media-body text-right">
							<a href="https://bbs.pediy.com/thread-create-88.htm" role="button" class="btn btn-sm btn-primary" style="float: right;">发新帖</a>
						</div>
		</ol>
		
	
		<div class="card">
			<div class="card-body">
				<dl class="row">
					<dt class="vtop" style="width: 56px; text-align: center;">
						<div class="avatar_info">
							<a href="https://bbs.pediy.com/user-662999.htm" aria-hidden="true" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/662999.png">
							</a>
							<div>
								<span class="group group-104" title="四级"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -6px; ">
																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 3</span>
															</div>
							
						</div>
					</dt>
					<!--
					<dd class="vtop" style="width: 100px;">
						<div class="text-grey" style="font-size: 9px; margin-top: 4px;">
							注册：2015-1 <br>
							帖子：28 <br>
														精华：<span class="text-danger font-weight-bold">3</span> <br>
														<span class="hidden-md-down" title=""></span>
						</div>
					</dd>
					-->
					<dd class="vtop">
						
						<h3 class="break-all subject">
																			
													[原创][开源]用C++实现的壳(扩展版)																			
									<i class="icon-digest-3" aria-hidden="true" title="精华"></i>
							
						</h3>
						
						<dl class="row small">
							<dt style="padding: 0px;">
								
								<span class="username font-weight-bold">
									<a href="https://bbs.pediy.com/user-662999.htm">cyxvc</a>
								</span>
								
								
								<span class="date text-grey ml-3">2016-1-1 13:47</span>
								<span class="text-grey ml-3 hidden-md-down"><i class="icon-eye" aria-hidden="true"></i> 21261</span>
								
							</dt>
							<dd class="text-right">
																<a href="javascript:void(0);" class="text-grey mr-3 modal-title" id="exampleModalLabel" data-toggle="modal" data-target=".report" data-tid="206873" data-pid="1409529"><i class="icon-warning" aria-hidden="true"></i> 举报</a>
																
																
															</dd>
						</dl>
											</dd>
				</dl>
				
				
				<hr aria-hidden="true">
					
				<div class="message break-all" isfirst="1">
								
					
					<font size="3"><font=""微软雅黑"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;前几天我写了篇【用C++实现的壳(基础版)】<a href="http://bbs.pediy.com/showthread.php?t=206804" target="_blank">http://bbs.pediy.com/showthread.php?t=206804</a>&nbsp;完成了一个非常纯洁的C++壳基础框架。现在这个【扩展版】的壳在之前的基础上增加了两个功能，一个是IAT加密，在一个就是机器码绑定。并修复了一些bug，静态编译了Shell.dll，使得在Win&nbsp;7&nbsp;x86和Win&nbsp;7&nbsp;x64位下都可以正常加壳了，如果加壳后的程序无法运行，请取消“IAT加密”选项，原因是我在IAT加密中使用了Hook-API，而Hook以后全当Call来处理了，实际有的程序IAT位置所填写的地址指向的并不全是Call指令，有时候是Mov指令，所以“IAT加密”功能的兼容性不足。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本来想增加反调试功能，可我实在水平有限，无法干掉StrongOD的反反调试功能，所以就没在拓展版中假如反调试功能，如果大家有什么好的反调试技术可以添加到这个壳子里，我在这就不献丑了...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;拓展版在界面上有了变化，增加了一些可选选项：</font=""微软雅黑""></font><br>
&nbsp;&nbsp;&nbsp;<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/662999_v5uzsw1zk4aitrl.jpg" width="513" height="386" class="div_message_boxShadow" style="cursor: pointer;"><br>
<br>
<font=""微软雅黑"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;下面就分别介绍一下“IAT加密”和“机器码绑定”这两个功能的实现。<br>
<br>
<font size="5">【IAT加密】</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我对IAT进行加密的思路是：<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;①首先定义一个自己的导入表数据结构，在Pack部分加壳的时候，读取被加壳程序的导入表信息并保存到我自己的导入表数据结构中，然后抹去被加壳程序的导入表数据；<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;②在Shell部分对IAT进行解密的时候，直接从我自己定义的导入表数据结构中获取修复IAT所用的信息，当通过这些信息获取到真正的函数地址后，将该地址填入一个new出来的堆空间1内保存，在这个堆空间1内加入一些花指令，最终再调用真正的函数地址。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如果直接将堆空间1的地址写入IAT，就完成了一个简单的IAT-Hook，但这样操作的话，真正的函数地址和要写入的IAT地址会同时出现，在反汇编中修改代码，直接将函数地址写入IAT地址的话，就会使得IAT-Hook失效，所以我没有直接将堆空间1写入IAT地址。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;③而是将堆空间1写入了一段又new出来的堆空间2，然后再在别的函数中，将堆空间2的地址写入IAT地址，这就能保证真正的函数地址和IAT地址不同时出现，这样的话，如果脱壳者在不了解我自己定义的导入表数据结构的情况下，是很难修复IAT并成功脱壳的。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我自己定义的IAT数据结构如下：<br>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  bash"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">typedef&nbsp;struct&nbsp;_MYIMPORT</code></div><div class="line number2 index1 alt1"><code class="bash plain">{</code></div><div class="line number3 index2 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">DWORD&nbsp;&nbsp;m_dwIATAddr;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">//IAT</code><code class="bash plain">地址</code></div><div class="line number4 index3 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">DWORD&nbsp;&nbsp;m_dwModNameRVA;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">//</code><code class="bash plain">模块名偏移</code></div><div class="line number5 index4 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">DWORD&nbsp;&nbsp;m_dwFunNameRVA;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">//</code><code class="bash plain">函数名偏移</code></div><div class="line number6 index5 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">BOOL&nbsp;&nbsp;m_bIsOrdinal;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">//</code><code class="bash plain">是否为序号导出函数</code></div><div class="line number7 index6 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">DWORD&nbsp;&nbsp;m_Ordinal;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">//</code><code class="bash plain">序号</code></div><div class="line number8 index7 alt1"><code class="bash plain">}MYIMPORT,&nbsp;*PMYIMPORT;</code></div></div></td></tr></tbody></table><br>
<br>
<font=""微软雅黑"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;示意图如下：<br>
&nbsp;&nbsp;&nbsp;<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/662999_vaalg4momh0vbt6.jpg" width="657" height="249" class="div_message_boxShadow" style="cursor: pointer; width: 524.205px; height: auto;"><br>
<br>
<font=""微软雅黑"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;经过这样处理后的IAT，在你停在原程序OEP的情况下，用IAT修复工具是很难进行自动修复的，修复失败，也就意味着不能脱壳成功。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如果大家感兴趣可以用这个壳对一个程序进行“IAT加密”，然后忘掉这个导入表数据结构，再脱脱壳感受一下，嘿嘿...<br>
<br>
<font=""微软雅黑"" deep="8"><font size="5">【机器码绑定】</font><br data-filtered="filtered">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这个其实没有什么技术含量，只是在逻辑上很难破解（在你不知道这个程序所绑定的机器码的情况下）。<br data-filtered="filtered">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;原理就是，用机器码1同代码段进行亦或操作，这样加过壳的程序就只能在机器码1的电脑上运行了，而如果在其他机器上运行，Shell部分在对机器码绑定进行解密的时候，获取的机器码同机器码1不同，这样解密出来的代码就是垃圾代码，根本无法运行，这样双击的效果为：<br data-filtered="filtered">
&nbsp;&nbsp;&nbsp;<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/662999_mjxzo6vzo96zvzx.jpg" width="509" height="288" class="div_message_boxShadow" style="cursor: pointer;"><br data-filtered="filtered">
<br data-filtered="filtered">
<font=""微软雅黑"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;大家在测试的时候，通过我打包的文件中的“查看机器码”查看本机的机器码，然后将这个机器码输入到加壳选项中，所加壳后的程序就只能在你的机器上运行了，如果改动一位，加壳后的程序运行时就会出错。<br data-filtered="filtered">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我这个获取机器码的代码是从网上找的，但貌似并不是真正的机器码，不过也无所谓，只要能保证每台机器所获取的信息都是不同且唯一的就行，原理一样。<br data-filtered="filtered">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br data-filtered="filtered">
<font size="5">【总结】</font><br data-filtered="filtered">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;给程序加壳其实就是拖慢破解者的进度，或者从数量上击垮对方，很难有脱不了的壳，除非是经过VM保护的代码才会很难分析。这就是一场加壳者和破解者之间的较量，再简单的壳也会有小菜脱不了，再难的壳也会有大牛能搞定。<br data-filtered="filtered">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注：测试环境为win7系统，32位和64位都可以，但在xp上不行，原因是Shell部分获取Kernel32.dll基址的时候的代码只适用于win7，xp的话需要删除一句“mov&nbsp;eax,&nbsp;[eax]”。如果你想要兼容xp的话，请从网上自行搜索获取Kernel32.dll基址的其他方法。<br data-filtered="filtered">
<br data-filtered="filtered">
<font=""微软雅黑"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;源码下载：<a href="https://bbs.pediy.com/attach-download-102243.htm"><i class="icon filetype zip"></i> CyxvcProtect(扩展版).rar</a>					
					
					<fieldset class="fieldset">
<legend>上传的附件：</legend>
<ul class="attachlist">
<li aid="102240">
		<a href="https://bbs.pediy.com/attach-download-102240.htm" target="_blank">
			<i class="icon filetype image"></i>
			1.jpg
		</a>
		<span class="">（63.13kb，22次下载）</span>
</li>
<li aid="102241">
		<a href="https://bbs.pediy.com/attach-download-102241.htm" target="_blank">
			<i class="icon filetype image"></i>
			2.jpg
		</a>
		<span class="">（21.98kb，17次下载）</span>
</li>
<li aid="102242">
		<a href="https://bbs.pediy.com/attach-download-102242.htm" target="_blank">
			<i class="icon filetype image"></i>
			3.jpg
		</a>
		<span class="">（115.91kb，7次下载）</span>
</li>
<li aid="102243">
		<a href="https://bbs.pediy.com/attach-download-102243.htm" target="_blank">
			<i class="icon filetype zip"></i>
			CyxvcProtect(扩展版).rar
		</a>
		<span class="">（1.49MB，1451次下载）</span>
</li>
</ul>
</fieldset>
					
					
								</font=""微软雅黑""></font=""微软雅黑""></font=""微软雅黑""></font=""微软雅黑""></font=""微软雅黑""></font=""微软雅黑""></div>
				
				<div>
								</div>
			</div>
		</div>
		
		                                
                <!--赞赏支持-->
                <div class="modal fade reward" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true">×</span>
                                            </button>
                                            <h4 class="modal-title" id="exampleModalLabel">赞赏</h4>
                                        </div>
                                        <form action="https://bbs.pediy.com/thread-206873.htm" method="post" id="pay_kx" onsubmit="return topay()">
                                                <div class="modal-body text-center">
                                                        <div class="form-group">
                                                                <input name="ureward" type="hidden" value="662999">
                                                                <input type="hidden" name="reward_articleid" value="206873">
                                                                <div class="avatar m-b-2 m-t-sm" style="width: 70px;height: 70px;display: inline-block;">
                                                                    <img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/dashang.png" alt="100">
                                                                </div>
                                                                
                                                                <div class="text-center m-b-2">
                                                                    <div class="" data-toggle="buttons">
                                                                        <label class="btn btn-outline-danger active" style="width:120px">
                                                                            <input type="radio" value="1" name="reward_rmbs" id="option1" autocomplete="off" checked="">1 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" value="2" name="reward_rmbs" id="option2" autocomplete="off">2 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" value="5" name="reward_rmbs" id="option3" autocomplete="off">5 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" value="10" name="reward_rmbs" id="option4" autocomplete="off">10 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" value="20" name="reward_rmbs" id="option5" autocomplete="off">20 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" value="50" name="reward_rmbs" id="option6" autocomplete="off">50 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" value="100" name="reward_rmbs" id="option7" autocomplete="off">100 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" value="200" name="reward_rmbs" id="option8" autocomplete="off">200 元
                                                                        </label>
                                                                    </div>
                                                                </div>

                                                                <div class="text-center">
                                                                    <label id="alipay_lab">
                                                                        <span>支付方式：</span>
                                                                        <input type="radio" value="1" checked="checked" name="reward_type" style="display:inline">
                                                                        <span class="alipay-bg"></span>
                                                                    </label>
                                                                   <!--  <label class="m-l-1">
                                                                        <input type="radio" value="3" name="reward_type">
                                                                        <i class="icon icon-weixin" style="font-size:17px;color:#49BE38"></i> 微信支付
                                                                    </label> -->
                                                                                                                                        <label class="m-l-1"><input type="radio" value="2" name="reward_type"> 余额（余额 ¥0.00）</label>
                                                                                                                                    </div>
                                                        </div>
                                                </div>

                                                <div class="modal-footer">
                                                        <button id="pay_submit" type="submit" class="btn btn-primary btn-pay kx-pay" data-loading-text="正在提交...">立即支付</button>
                                                </div>
                                        </form>
                                </div>
                        </div>
                </div>
		<style>
			.card_collection { vertical-align: middle; display: inline-block; border: 1px solid #eee; background: #EEEEEE; padding: 0px 8px; border-radius: 5px; }
			.card_collection p { margin-bottom: 0px;font-size: 12px;}
			.card_collection p a { text-decoration: none; }
			.alipay-bg { width: 60px;height: 20px;display: inline-block;vertical-align: middle;background: url(view/img/reward_alipay.png) 0 0 no-repeat;}
		</style>
		<div class="card" style="background:#F9F9F9;text-align:center;padding:5px 0px;">
			<div style="width:auto;display:inline-block;">
				<div class="card_collection" style="width: 70px; height: 65px;line-height:30px">
					<p><a href="http://bbs.pediy.com/user-collection.htm"><b id="likes">66</b></a></p>
					<p id="favorite">
						<a href="javascript:void(0)" title="点我收藏">
														<i class="icon-star-o"></i>&nbsp;收藏
													</a>
					</p>
				</div>
				
				<div class="card_collection">
					<a href="javascript:void(0);" class="modal-title" id="exampleModalLabel" data-toggle="modal" data-target=".reward"><img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/dashang.png" alt="赞赏" style="width:60px;vertical-align: middle;" title="现金赞赏支持"></a>
				</div>
				
				<div class="card_collection">
					<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/bbs_qrcode-http_3A_2F_2Fbbs_2epediy_2ecom_2Fthread_2d206873_2ehtm.htm" alt="二维码" style="width:60px;height:60px;vertical-align: middle; ">
				</div>
			</div>
		</div>

		<div class="card p-1">
			<div class="card-body">
				<table class="table postlist mb-0">
					<thead>
						<tr>
							<th colspan="2" class="pa-0  pb-1">
								<dl class="row">
									<dt>
										<b>最新回复</b> (<span class="posts">68</span>)
									</dt>
									<dd style="text-align: right;">
										
										
																				<nav class="text-right pagination-sm" style="height: 27px;"><ul class="pagination mt-0 mb-0"><li class="page-item active"><a href="https://bbs.pediy.com/thread-206873-1.htm" class="page-link">1</a></li><li class="page-item"><a href="https://bbs.pediy.com/thread-206873-2.htm" class="page-link">2</a></li><li class="page-item"><a href="https://bbs.pediy.com/thread-206873-2.htm" class="page-link">▶</a></li></ul></nav>
																				
									</dd>
								</dl>
							</th>
						</tr>
					</thead>
					<tbody>
					
														
				
																			
															
					<tr class="post" pid="1409534">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-686289.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/686289.png">
							</a>
							<div>
								<span class="group group-108 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2015-7 <br>
								帖子：443 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 11</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-686289.htm">Netfairy</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-1 14:23</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409534" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409534" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409534" class="text-grey mr-3"><span class="floor">3</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								感谢分享，之前我也研究过写壳																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409537">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-646248.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/avatar.png">
							</a>
							<div>
								<span class="group group-101 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2014-8 <br>
								帖子：113 <br>-->

								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-646248.htm">smurf</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-1 14:49</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409537" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409537" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409537" class="text-grey mr-3"><span class="floor">4</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								支持一下，顶起																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409541">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-611407.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/611407.png">
							</a>
							<div>
								<span class="group group-101 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2013-11 <br>
								帖子：231 <br>-->

								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-611407.htm">ID蝴蝶</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-1 15:13</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409541" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409541" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409541" class="text-grey mr-3"><span class="floor">5</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								支持一下，顶起。																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409557">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-466641.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/466641.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2011-11 <br>
								帖子：274 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-466641.htm">pxhb</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-1 17:25</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409557" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409557" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409557" class="text-grey mr-3"><span class="floor">6</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								非常感谢分享																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409558">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-533959.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/533959.png">
							</a>
							<div>
								<span class="group group-101 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2012-7 <br>
								帖子：38 <br>-->

								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-533959.htm">yunshouhu</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-1 17:26</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409558" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409558" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409558" class="text-grey mr-3"><span class="floor">7</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								不错，支持楼主，等放假回来再看看。																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409560">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-466641.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/466641.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2011-11 <br>
								帖子：274 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-466641.htm">pxhb</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-1 17:34</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409560" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409560" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409560" class="text-grey mr-3"><span class="floor">8</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								方便传个vs2010版本的吗																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409562">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-662999.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/662999.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2015-1 <br>
								帖子：28 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 3</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-662999.htm">cyxvc</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-1 18:00</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409562" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409562" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409562" class="text-grey mr-3"><span class="floor">9</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								我电脑上只有VS2013啊<br>
<br>
不过我给你百度了一下如何解决问题<br>
<br>
希望能帮到你：<br>
<a href="http://blog.csdn.net/civilman/article/details/40109483" target="_blank">http://blog.csdn.net/civilman/article/details/40109483</a>																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409594">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-233154.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/233154.png">
							</a>
							<div>
								<span class="group group-103 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2009-1 <br>
								帖子：189 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 1</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-233154.htm">zfdyq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-2 00:01</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409594" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409594" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409594" class="text-grey mr-3"><span class="floor">10</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								good job<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/28.gif" width="24" height="24" style="cursor: pointer;">																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409625">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-466641.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/466641.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2011-11 <br>
								帖子：274 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-466641.htm">pxhb</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-2 10:22</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409625" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409625" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409625" class="text-grey mr-3"><span class="floor">11</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								非常感谢回复<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/28.gif" width="24" height="24" style="cursor: pointer;"><br>
要是以后加入虚拟机引擎就爽了																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409714">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-237568.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/237568.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2009-1 <br>
								帖子：289 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-237568.htm">czcqq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 01:00</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409714" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409714" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409714" class="text-grey mr-3"><span class="floor">12</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								感谢分享！挑战一下自己，明天开始研究如何破解																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409720">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-237568.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/237568.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2009-1 <br>
								帖子：289 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-237568.htm">czcqq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 03:19</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409720" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409720" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409720" class="text-grey mr-3"><span class="floor">13</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								看了一下你的加密程序，有思路了，嘿嘿代码加密的找到入口点，等你自己解密了之后，就行，至于IAT加密，嘿嘿，也不难啊！可以采用，已知明文破解的办法，就是用VC编写一个静态加载自己DLL的程序，编写之后，用PE编辑工具打开这个文件，打开之后，查看导出表在文件地址，根据对齐值，计算一下加载到内存时的位置，记下这个位置，接着用楼主的程序加壳，加壳之后用OD加载被加壳的程序，拿着刚刚已经计算好的IAT地址加上模块的加载地址，就可以知道IAT地址，然后在IAT地址上下内存断点，在LoadLibraryW GetProcAddress GetModuleHandleW等函数上下执行断点，接着就调试，嘿嘿，看是什么指令写入了IAT，什么位置调用了GetProcAddress&nbsp;&nbsp;以及加载了什么模块，等加载自己的DLL的时候，就自己手动通过EAT获取自己DLL的函数的地址，然后填入刚刚加壳程序填入的IAT地址，看是否会直接调用你的程序，如果直接调用，而没有经过加壳程序的话，就说明你获取的IAT写入地址正确了，嘿嘿，用这个方法手工恢复吧！要是获取的IAT地址不正确，就继续调试，直到能获取正确的IAT地址为止！																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409736">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-662999.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/662999.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2015-1 <br>
								帖子：28 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 3</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-662999.htm">cyxvc</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 10:10</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409736" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409736" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409736" class="text-grey mr-3"><span class="floor">14</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/27.gif" width="24" height="24" style="cursor: pointer;"> 你这个思路实现了吗？ 我获取到真正的函数地址以后，不是直接填到对应的IAT地址的啊。。而是直接填到一块new出来的堆空间中的啊，而这个堆空间中填的地址也不是直接就是函数地址，是一段ShellCode的地址，经过一些花指令以后才会call真正的函数地址。<br>
你dump以后成功修复IAT了？<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/1.gif" width="24" height="24" style="cursor: pointer;"> (加壳的时候别忘了选择IAT加密<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/41.gif" width="24" height="24" style="cursor: pointer;">)																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409742">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-237568.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/237568.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2009-1 <br>
								帖子：289 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-237568.htm">czcqq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 10:22</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409742" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409742" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409742" class="text-grey mr-3"><span class="floor">15</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								部分实现，通过一个已知的DLL的API，我已经定位到了解码IAT的程序！已经找到了IAT原地址，你即使申请了new的地址，你也必须向原IAT地址填写一个HOOK，不是么？跟踪到后面的结果是，如果没有进行IAT加密的话，会发现惊喜，不过经过测试，加密之后也没事，你同样会发现惊喜！																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409744">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-237568.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/237568.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2009-1 <br>
								帖子：289 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-237568.htm">czcqq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 10:25</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409744" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409744" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409744" class="text-grey mr-3"><span class="floor">16</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								没有完全实现的原因，只是因为我跟踪到IAT之后，累了，就先休息了，嘿嘿，等过两天，我有空了，继续挑战，嘿嘿！不过表扬一下，花指令还是不错，不过，不是很强大，花了我多一点事件读取而已																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409746">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-662999.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/662999.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2015-1 <br>
								帖子：28 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 3</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-662999.htm">cyxvc</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 10:28</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409746" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409746" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409746" class="text-grey mr-3"><span class="floor">17</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								哇，多谢大牛赐教！<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/27.gif" width="24" height="24" style="cursor: pointer;"><br>
<br>
调试方面我还是太弱啊，回头研究研究你说的这种方法！<br>
<br>
感谢感谢！<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/28.gif" width="24" height="24" style="cursor: pointer;">																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409778">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-533959.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/533959.png">
							</a>
							<div>
								<span class="group group-101 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2012-7 <br>
								帖子：38 <br>-->

								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-533959.htm">yunshouhu</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 14:32</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409778" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409778" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409778" class="text-grey mr-3"><span class="floor">18</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								1、本人环境为vs2010,附件中的源码存在问题，开始直接编译不通过。<br>
需修改shell.cpp 245行279行添加等号。<br>
2、修改完各种错误后静态编译出来的shell.dll只有38kb,而楼主所给的shell.dll为78kb不知是什么原因。(基本的环境配置我没有修改，只修改编译错误信息。)<br>
3、使用楼主的shell.dll加壳在win7 x64系统可以正常运行，但是使用楼主源码编译出来的exe和dll加壳后运行弹出对话框后运行出错。第二次输出信息为：<br>
runtime error R6009<br>
- not enough space for environment<br>
4、猜想附件中的源码是不是最终版本。																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409784">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-662999.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/662999.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2015-1 <br>
								帖子：28 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 3</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-662999.htm">cyxvc</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 15:52</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409784" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409784" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409784" class="text-grey mr-3"><span class="floor">19</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								我用的是VS2013开发的。<br>
我给出的那个78kb的Shell.dll是我在VS2013下静态编译的( 运行库：多线程 MT )Release版。<br>
<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/662999_31vz9watie7jq3x.jpg" width="520" height="41" class="div_message_boxShadow" style="cursor: pointer; width: 445.205px; height: auto;"><br>
<br>
你试一下你自己编译exe文件配上压缩包里自带的Shell.dll(78kb)看能不能正常加壳。如果能的话就说明是Shell编译的问题。<br>
<br>
确定一下你的dll项目是否是Release(之前为了调试方便，我把shell项目Release的生成目录改成了Debug目录)，再确定一下Shell项目是不是按照上图中的方式设置。<br>
<br>
在我电脑上下载下来源码然后直接编译出来，加壳是没问题的。<br>
<br>
看来VS低版本对高版本的兼容性不太好吧，你也可以看看这个迁移方案，希望能够帮到你：<br>
<a href="http://blog.csdn.net/civilman/article/details/40109483" target="_blank">http://blog.csdn.net/civilman/article/details/40109483</a>																<fieldset class="fieldset">
<legend>上传的附件：</legend>
<ul class="attachlist">
<li aid="102270">
		<a href="https://bbs.pediy.com/attach-download-102270.htm" target="_blank">
			<i class="icon filetype image"></i>
			1.JPG
		</a>
		<span class="">（11.45kb，4次下载）</span>
</li>
</ul>
</fieldset>
								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409804">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-237568.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/237568.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2009-1 <br>
								帖子：289 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-237568.htm">czcqq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 17:17</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409804" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409804" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409804" class="text-grey mr-3"><span class="floor">20</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								已经可以破解了，嘿嘿，多谢你的加壳程序了，我已经弄好了，等我整理好了，吃了晚饭，我就上传破解办法以及资料,先上传截图，等我晚上弄好以后，再上传教程，嘿嘿，肚子饿了，晚上才弄																<fieldset class="fieldset">
<legend>上传的附件：</legend>
<ul class="attachlist">
<li aid="102284">
		<a href="https://bbs.pediy.com/attach-download-102284.htm" target="_blank">
			<i class="icon filetype zip"></i>
			破解资料.rar
		</a>
		<span class="">（1.99MB，63次下载）</span>
</li>
</ul>
</fieldset>
								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409811">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-436125.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/436125.png">
							</a>
							<div>
								<span class="group group-101 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2011-6 <br>
								帖子：90 <br>-->

								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-436125.htm">Promisejhy</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 17:50</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409811" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409811" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409811" class="text-grey mr-3"><span class="floor">21</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								留个记号，持续关注楼主的更新。																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409814">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-237568.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/237568.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2009-1 <br>
								帖子：289 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-237568.htm">czcqq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 18:14</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409814" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409814" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409814" class="text-grey mr-3"><span class="floor">22</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								楼主，你的加密程序，我已经破解好了，但是我现在在考虑是不是要公布做法，来教一教大家呢？等我公布了，我怕楼主又不高兴了！																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409819">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-662999.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/662999.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2015-1 <br>
								帖子：28 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 3</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-662999.htm">cyxvc</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 18:32</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409819" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409819" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409819" class="text-grey mr-3"><span class="floor">23</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								啊...暂时没有更新的打算了，我就是提供个框架，整点简单的加密而已，<br>
主要是抛砖引玉哈哈...																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409820">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-662999.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/662999.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2015-1 <br>
								帖子：28 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 3</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-662999.htm">cyxvc</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 18:33</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409820" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409820" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409820" class="text-grey mr-3"><span class="floor">24</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								没啥不高兴的，我这壳本来就是供大家学习的，我自己水平也有限，有大牛来指点当然是极好的了！<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/27.gif" width="24" height="24" style="cursor: pointer;">																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409821">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-237568.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/237568.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2009-1 <br>
								帖子：289 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-237568.htm">czcqq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 18:38</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409821" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409821" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409821" class="text-grey mr-3"><span class="floor">25</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								楼主犯了一个小错误，导致我可以直接在你的程序中，直接截取你的IAT填写以及复制过程，在这个过程中，可以在堆栈中记录到导出模块已经导出函数名，楼主在申请新的IAT地址前，使用了LoadLibrary和GetModuleHandle，这两个函数调用时，在堆栈上可以看到我们想要的模块，赶紧的，记录下来呗！，使用了GetProAddress,没有清空EAX寄存器的值，而是，将EAX与15151515h进行异或之后填写入局部变量中，然后就申请了新的内存，新内存地址就保存在EAX中，然后以EAX作为返回值，新的内存用来填写ShllCode,而ShllCode中对原函数的回调用的地址就直接写入SHELLCODE，同时把ShllCode地址存在一个变量中，这个变量，后来又被取出，用来填写真正的IAT地址！我只需截取 ShellCode，让ShellCode的地址指向原函数，并且取消对ShellCode的填写操作，然后用OD将对应的代码回填到可执行文件中，并且在你的程序回填IAT HOOK的时候，记录你的IAT地址就行，有了IAT地址，又有正确的模块加载列表，函数列表，以及IAT的函数地址的链表，恢复IAT不好办么？																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409822">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-237568.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/237568.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2009-1 <br>
								帖子：289 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-237568.htm">czcqq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 18:49</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409822" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409822" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409822" class="text-grey mr-3"><span class="floor">26</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								楼主，你想破解的话，先准备工具，需要的工具ollydbg<br>
Cheat Engine和VS2010，以及楼主的加壳程序！<br>
楼主，我先编辑资料，写上破解过程，等一下我发上来																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409823">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-662999.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/662999.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2015-1 <br>
								帖子：28 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 3</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-662999.htm">cyxvc</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 18:51</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409823" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409823" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409823" class="text-grey mr-3"><span class="floor">27</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								OK，那麻烦您了！贡献资料供大家学习！感谢感谢！<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/28.gif" width="24" height="24" style="cursor: pointer;">																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409825">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-237568.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/237568.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2009-1 <br>
								帖子：289 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-237568.htm">czcqq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 19:08</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409825" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409825" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409825" class="text-grey mr-3"><span class="floor">28</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								对了，还需要一个PE文件编辑器，我这里选择的是PE Exolorer																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409839">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-400051.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/400051.png">
							</a>
							<div>
								<span class="group group-101 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2011-1 <br>
								帖子：48 <br>-->

								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-400051.htm">雅鸦歌</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 21:29</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409839" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409839" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409839" class="text-grey mr-3"><span class="floor">29</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								顶下学员。。。。																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409845">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-237568.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/237568.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2009-1 <br>
								帖子：289 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-237568.htm">czcqq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 22:15</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409845" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409845" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409845" class="text-grey mr-3"><span class="floor">30</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								楼主，你想破解的话，先准备工具，需要的工具ollydbg, PE Exolorer<br>
Cheat Engine和VS2010，以及楼主的加壳程序！<br>
先用VS2010建立一个控制台工程，<br>
工程代码如下<br>
#include "stdafx.h"<br>
#include &lt;Windows.h&gt;<br>
int _tmain(int argc, _TCHAR* argv[])<br>
{<br>
&nbsp; &nbsp; &nbsp; &nbsp; _asm int 3//这个代码一定需要，这个代码调用时会加载调试器，用来在不同调试器中使程序断在我想要的位置<br>
&nbsp; &nbsp; &nbsp; &nbsp; while(1)<br>
&nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; while(::MessageBox(0,L"是否记录到导出表?",L"Test",MB_YESNO)==IDYES)<br>
&nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return 0;<br>
&nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; return 0;<br>
}<br>
然后打开工程设置，将工程设置为固定基地址，以及取消地址虚拟化，取消VC代码的折叠优化，不做以上设置，就会影响破解！<br>
解释一下为什么要设置死循环，就是需要减少程序的启动次数！<br>
好，将工程编译为Release版本，我们调试一下，没问题，正常调用！<br>
用加密程序加密吧！加密时选择IAT加密，以及代码段加密，选择出现提示，以便我们附加需要的调试器，而程序中的INT 3指令，是帮助我们的调试器定位在我们的代码的，其余的我们都不<br>
<br>
选，以免影响我们的破解！<br>
//我们准备好已经加密过的程序以后,用PE Exolorer打开未加密的文件，查看一下导出表地址，我这里是00402224h 大小50h ，导出函数链表地址为00402000h 记录下来，备用<br>
然后直接运行加密后的程序，如果加密无误，会弹出崩溃提示，这时我们附加VC的调试器上去，会看到VC弹出提示，遇到我们先前设置的断点！<br>
断点后面的代码如下<br>
00401003&nbsp;&nbsp;int&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;3&nbsp;&nbsp;//这里就是我们设置的断点，VC附加无误后会断在这里！<br>
00401004&nbsp;&nbsp;mov&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;eax,1&nbsp;&nbsp;<br>
00401009&nbsp;&nbsp;test&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;eax,eax&nbsp;&nbsp;<br>
0040100B&nbsp;&nbsp;je&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; 0040102E&nbsp;&nbsp;<br>
0040100D&nbsp;&nbsp;push&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;<br>
0040100F&nbsp;&nbsp;push&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;4020F4h&nbsp;&nbsp;<br>
00401014&nbsp;&nbsp;push&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;402100h&nbsp;&nbsp;<br>
00401019&nbsp;&nbsp;push&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;<br>
0040101B&nbsp;&nbsp;call&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;dword ptr ds:[4020A4h]//当运行到这里时，记录一下括号里面的值，我这里是4020A4h，然后找到导出表开始的地<br>
记录值之后，停止VC调试，<br>
打开Cheat Engine 61，然后运行加密过的程序，等弹出提示的时候，用CE附加它，然后选择手动添加指针，然后填入00402000<br>
，添加指针之后，在指针列表上单击右键，选择找出是谁改写了这个指针，然后继续运行程序，之后CE会记录到，到底是什么地方改写了这个指针，也就是IAT的指针<br>
接着打开CE的记录，单击第一个记录（一般是第一个的），然后点击 显示反汇编工具，就会自动找到改写这个IAT的地址，我这里是0040AFC8，<br>
0040AFB0 - mov eax,[00407140] : [0041B000]<br>
0040AFB5 - lea ecx,[esi+esi*4]<br>
0040AFB8 - mov edx,[eax+ecx*4]<br>
0040AFBB - mov eax,[004169C0] : [00260000]<br>
0040AFC0 - mov ecx,[eax+esi*4]<br>
0040AFC3 - mov eax,[004169D0] : [00400000]<br>
0040AFC8 - mov [eax+edx],ecx<br>
这时我们观察一下寄存器的值，<br>
<br>
EAX=00400000<br>
EBX=00270000<br>
ECX=006B0000<br>
EDX=00002000<br>
ESI=0000000F<br>
EDI=00000000<br>
ESP=0018FF74<br>
EBP=0018FF88<br>
发现什么情况没有？<br>
eax+edx=00402000 EAX就是模块基地址，那么EDX就是相对偏移 这么说这里的EDX保存的是原导入表地址啦？赶紧保存<br>
什么情况00402000不是原导入表地址么？这里怎么进行了赋值操作？<br>
ECX的值哪里来的？<br>
mov ecx,[eax+esi*4]这里来的！<br>
这句代码一看就知道类似 Addr[i]=值<br>
那EAX的值就应该等于Addr的地址啦！<br>
mov eax,[004169C0] : [00260000]<br>
这里赋值EAX<br>
看004169C0指向的地址，这像一个变量（经验判断的）<br>
接着，在CE中添加地址，勾选指针类型，偏移量，我们写0<br>
然后重启被加密的程序，然后附加CE，找到刚才添加的指针，右键，选择找出是谁访问了这个指针，弹出的对话框中选择第一个<br>
然后，回到被加密程序中，单击确定，这时CE就记录了是谁访问了这个变量！<br>
在弹出的代码列表中，选择第一个（一般都是第一个的）<br>
然后按旁边的反汇编按钮，定位到改写这个变量的地址<br>
我这里是0040B3BD<br>
得到获取IAT地址的指令在那之后，<br>
接下来就只能靠OD了，打开OD，用OD加载被加密程序之后，定位到0040B3BD<br>
然后下断点，接下来，凭经验，找到填写这个地址的函数头，在那里下断点，<br>
然后按F9运行，接着被加密程序会弹出消息框，我们单击确定，然后会陷入我们OD下的断点中，<br>
接着，仔细了哦！别漏了，这里要有重要的事情发生了，仔细看寄存器，以及OD的显示<br>
运行到0040b213处时，发生了什么事情？ECX寄存器里，居然得到了解密之后的模块文件名，<br><br>留一个题，你们自己分析，在上面已经运行过的代码中，可以分析出，加密的密钥是什么！<br>
你们自己去分析吧！我就不去分析了直接修改代码，让解密以后，再进行加密混淆的代码无法运行！<br>
<br>
模块文件名，我们得到了，接下来，继续运行<br>
运行到0040B369处时候，我们得到了什么？居然是调用GetProceAddress哈哈，这就好办了，第一个参数是模块地址，第二个就是函数名！这就好办了，不用说，记录！<br>
我们继续调试，当GetProceAddress返回时，居然看见了一个让我惊喜的东西，在0040B378处，看到了xor eax,15151515,哈哈，加密混淆指令，明显是使用GetProceAddress返回的地址与<br>
<br>
15151515进行异或，当然不允许了，直接用NOP填充，接下来<br>
函数调用了VirtualAlloc申请了内存，用来干嘛呢？接下来，有一大堆的指令，如果没有EAX寄存器的指令，我们直接忽略，接下来到了<br>
0040B3A4 指令处，注意啊！注意看ECX的值，以及指令，<br>
MOV DWORD PTR DS:[EDX*4+ECX],EAX这个指令很熟悉吧？不就是和前面赋值IAT的指令相似么？<br>
再看看作为基地址的ECX的内容，ECX居然等于00260000，这不是前面的用于赋值给IAT的变量么？原来在这里，嘿嘿，不用说的，直接吧正确的地址给写回去，也就是GetProceAddress返回的<br>
<br>
地址，写回去，把0040B396到0040B39F用NOP填充掉，把0040B36F到0040B388全部用NOP填充掉，下面，就是一些清除原导入表的操作，不用说的，果断NOP掉，别忘了保存一下函数与导入表的<br>
<br>
关系，以及需要写入导出表的地址，否则，破解就白做了，<br>
然后就用OD保存修改，<br>
再用OD加载修改之后的程序，定位到OEP的最后的RET指令，这时在堆栈顶端，就可以看见原来的OEP，果断保存！<br>
到此，我们得到了，模块名，函数名，以及对应的需要写入的IAT的地址：第一个IAT函数地址就是 00402000+0*4，第二个就是00402000+1*4，第三个就是00402000+2*4，以此类推，就能填写<br>
<br>
IAT了，有了模块名，和函数名，自己写一个模块名与函数名的链表，然后就将IAT指向原IAT就行！<br><br>破解与获取IAT，以及获取OEP的方法，大家可以看看，哈哈有了原程序的IAT信息，我们自己构建IAT了，就不用麻烦楼主的壳给我恢复IAT了，也就直接过了你的老师的花指令！<br>
<br>
好累啊！接下来的自己构建IAT的事，嘿嘿留给楼主自己了，看电脑久了，头大了！																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409846">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-237568.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/237568.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2009-1 <br>
								帖子：289 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-237568.htm">czcqq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 22:20</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409846" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409846" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409846" class="text-grey mr-3"><span class="floor">31</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								以上的破解做了之后，记录下之后，还要减去基地址0x0040000,才是正确的RVA,在下一次，调试时需要加上模块的基地址，才能得到真正的内存数据！别搞错，不要直接引用我的数据哦！我的数据只针对我的机器，不同机器的基地址是不同的，只有RVA是一样的哦！因此，得到相应的地址之后需要做计算的哦！																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409848">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-237568.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/237568.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2009-1 <br>
								帖子：289 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-237568.htm">czcqq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 22:32</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409848" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409848" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409848" class="text-grey mr-3"><span class="floor">32</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								我写错了，我改为<br><br>以上的破解做了之后，记录下之后，还要减去OEP所在节的基地址（我这里是0x00405000）,才是正确的RVA,在下一次，调试时需要加上OEP所在节的基地址，才能得到真正的内存数据！别搞错，不要直接引用我的数据哦！我的数据只针对我的机器，不同机器的基地址是不同的，只有RVA是一样的哦！因此，得到相应的地址之后需要做计算的哦！<br>
<br>
OEP所在节的基地址可以用PE Explorer，读取PE文件，查询到va，进而查询到rva，或者也可以使用debug相关的函数查询到RVA，相关知识可以去看PE文件结构了解																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409851">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-237568.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/237568.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2009-1 <br>
								帖子：289 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-237568.htm">czcqq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-3 22:41</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409851" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409851" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409851" class="text-grey mr-3"><span class="floor">33</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								我以上的破解方法，可以说是已知明文破解，也就是说，我知道解密后的程序，以及解密前的程序，然后调试解密的程序本身，通过对解密程序本身的调试，知道了它是如何工作的，以及工作需要的资源是存储在哪！然后，既然我知道了，加密程序的相关的资源在哪，以及是如何工作的，那么破解这个壳加密的别的程序，我就依样画葫芦，直接读取资源，然后破解就行了，这就是我的思路，说起来，这方法我是在红盟的教程里面学的，然而，这个教程里面却说，这种破解方法源自日本，是日本甲午战争的时候破解我国莫尔斯电码时用的方法！汗颜啊！																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409859">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-237568.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/237568.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2009-1 <br>
								帖子：289 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-237568.htm">czcqq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-4 00:13</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409859" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409859" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409859" class="text-grey mr-3"><span class="floor">34</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								建议楼主<br>
OEP处先保存一下各个寄存器的值，备用！对IAT加密解密程序，代码进行加密，<br>
然后申请一段内存，存入加密过的IAT，然后设置权限为无法读取，以及写入，然后注册一个异常回调函数，在准备进入原程序的OEP前，写一个有缓冲区溢出缺陷的函数，然后故意触发缓冲区溢出，在溢出的堆栈指向的地址中，我们写一个具有除0错误的汇编程序，然后这个汇编程序就修正堆栈，让其返回正常的函数，嘿嘿，这样除0错误，会被异常回调函数处理，异常回调函数会取得先前保存的OEP的各个寄存器的值，然后恢复寄存器，恢复寄存器后，我们就可以恢复IAT了，存入加密过的IAT的那段新的内存给予读取权限，然后恢复IAT，恢复以后，将模块名，全部指向一个系统存在，但是并没有加载的DLL，然后，将OEP地址恢复到EIP中，最后结束异常处理，然后卸载异常处理函数，当异常处理函数返回时，就跳到了原程序的OEP中了，而如果，在程序运行开始时有调试器试图附加，来调试你的IAT解密过程的话，由于调试器处理了缓冲区溢出，以及除0错误，所以不会导致异常处理代码的执行，那么IAT也就没有机会解密，这样就会导致程序无法完全解密了，同时破解难度也会提升的！																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409860">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-662999.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/662999.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2015-1 <br>
								帖子：28 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 3</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-662999.htm">cyxvc</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-4 00:52</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409860" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409860" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409860" class="text-grey mr-3"><span class="floor">35</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								大牛，你这个对OEP的处理很棒的说！学习了学习了！！！																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409870">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-314009.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/314009.png">
							</a>
							<div>
								<span class="group group-101 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2010-1 <br>
								帖子：62 <br>-->

								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-314009.htm">sdnyzjzx</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-4 08:27</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409870" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409870" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409870" class="text-grey mr-3"><span class="floor">36</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								从头开始学起。感谢分享！																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409884">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-85858.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/avatar.png">
							</a>
							<div>
								<span class="group group-101 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2007-4 <br>
								帖子：25 <br>-->

								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-85858.htm">jxlmz</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-4 09:26</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409884" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409884" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409884" class="text-grey mr-3"><span class="floor">37</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								我先去看看基础版的，回头再来深入研究这个																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409895">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-618335.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/618335.png">
							</a>
							<div>
								<span class="group group-101 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2014-1 <br>
								帖子：237 <br>-->

								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-618335.htm">蚯蚓降龙</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-4 10:01</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409895" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409895" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409895" class="text-grey mr-3"><span class="floor">38</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								这个应该是加密壳类型的吧,根本就没压缩性...<br>
选了代码段加密,然而代码段还是有一堆原指令出现,<br>
iat加密比较简单,find #EB02FF15C3000000#几下就能修复了<br>
StrongOD好久没更新了,bug也是有不少的																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1409989">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-237568.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/237568.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2009-1 <br>
								帖子：289 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-237568.htm">czcqq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-4 18:54</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1409989" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1409989" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1409989" class="text-grey mr-3"><span class="floor">39</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								这只是用来学习的，可以用来练手，不要纠结这么多																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1410196">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-237568.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/237568.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2009-1 <br>
								帖子：289 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-237568.htm">czcqq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-5 22:00</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1410196" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1410196" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1410196" class="text-grey mr-3"><span class="floor">40</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								楼主，刚刚写了一个隐藏OEP地址的壳代码的例子，要不要看一下？采用了异常处理链的方式调用了OEP，我想你如果想加强你的壳，你可以看一下嘿嘿，OEP中绝对不会出现原OEP地址，而且附带了部分的调试器检测功能！																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1410205">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-662999.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/662999.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2015-1 <br>
								帖子：28 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 3</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-662999.htm">cyxvc</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-5 22:55</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1410205" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1410205" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1410205" class="text-grey mr-3"><span class="floor">41</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/1.gif" width="24" height="24" style="cursor: pointer;"><br>
<br>
我怕我真心看不懂了，我觉得我把这个壳的代码给你拓展，然后你再发个帖子普罗大众一下吧嘿嘿<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/12.gif" width="24" height="24" style="cursor: pointer;"><br>
<br>
我们现在开始学内核了，时间比较紧，壳我想就先放一放了...																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1410211">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-237568.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/237568.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2009-1 <br>
								帖子：289 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-237568.htm">czcqq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-5 23:38</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1410211" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1410211" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1410211" class="text-grey mr-3"><span class="floor">42</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								内核不好玩的，玩内核你小心了，给你个忠告，玩内核编程千万要注意，你得先准备几块硬盘！我玩内核编程时，报废了三块硬盘，以及一块显卡，BOSS被我弄坏了一次，系统嘛就不知道弄坏了多少次，嘿嘿，还是RING3好，绝对不会弄坏硬件！另外，你的壳我的VC 不支持，我还是贴出来吧！你自己能看懂多少就多少了，另外壳程序，我早就写过了，而且是半汇编的<br><br>代码如下// SetHardWare.cpp : 定义应用程序的入口点。<br>
//<br>
<br>
#include "stdafx.h"<br>
#include "SetHardWare.h"<br>
typedef <br>
ULONG<br>
(NTAPI <br>
*PRtlNtStatusToDosError)(<br>
&nbsp; &nbsp;ULONG Status<br>
&nbsp; &nbsp;);<br>
//#include "../../testbase/Memory/Memory.h"<br>
//PRtlNtStatusToDosError RtlNtStatusToDosError=(PRtlNtStatusToDosError)::GetProcAddress(::GetModuleHandle(L"Ntdll.dll"),"RtlNtStatusToDosError");<br>
#include "../../BPHookFunction/BPHookFunction/BPHookFunction.h"<br>
//#include "../../testbase/Memory/Memory.h"<br>
#define MAX_LOADSTRING 100<br>
typedef ULONG (WINAPI *pfnRtlDispatchException)(PEXCEPTION_RECORD pExcptRec,CONTEXT * pContext);<br>
 pfnRtlDispatchException m_fnRtlDispatchException=(pfnRtlDispatchException)::GetProcAddress(::GetModuleHandleA("ntdll"),"KiUserExceptionDispatcher");;<br>
// 全局变量:<br>
HINSTANCE hInst;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 当前实例<br>
TCHAR szTitle[MAX_LOADSTRING];&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 标题栏文本<br>
TCHAR szWindowClass[MAX_LOADSTRING];&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 主窗口类名<br>
int APIENTRY _tWinMain2(HINSTANCE hInstance,<br>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;HINSTANCE hPrevInstance,<br>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;LPTSTR&nbsp; &nbsp; lpCmdLine,<br>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;int&nbsp; &nbsp;&nbsp; &nbsp; nCmdShow);<br>
// 此代码模块中包含的函数的前向声明:<br>
ATOM&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MyRegisterClass(HINSTANCE hInstance);<br>
BOOL&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; InitInstance(HINSTANCE, int);<br>
LRESULT CALLBACK&nbsp; &nbsp; &nbsp; &nbsp; WndProc(HWND, UINT, WPARAM, LPARAM);<br>
INT_PTR CALLBACK&nbsp; &nbsp; &nbsp; &nbsp; About(HWND, UINT, WPARAM, LPARAM);<br>
int APIENTRY _tWinMain2(HINSTANCE hInstance,<br>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;HINSTANCE hPrevInstance,<br>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;LPTSTR&nbsp; &nbsp; lpCmdLine,<br>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;int&nbsp; &nbsp;&nbsp; &nbsp; nCmdShow);<br>
LONG WINAPI MyTopUnhandledExceptionFilter(<br>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;struct _EXCEPTION_POINTERS *ExceptionInfo<br>
);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp;&nbsp;extern "C" __declspec(dllimport) ULONG NTAPI&nbsp;&nbsp;RtlNtStatusToDosError(<br>
//&nbsp;&nbsp;_In_ LONG Status<br>
//);<br>
BOOL RtlDispatchException(PEXCEPTION_RECORD pExcptRec,CONTEXT * pContext)<br>
{<br>
&nbsp;&nbsp;// 返回TRUE,这个异常我已经处理好了,继续运行程序<br>
&nbsp;&nbsp;// 返回FALSE,这个异常不是我的,找别人处理去<br>
&nbsp; &nbsp; &nbsp; &nbsp; MessageBox(0,L"DDDD",L"DDSADS",0);<br>
&nbsp; &nbsp; &nbsp; &nbsp; return 1;<br>
}<br>
ULONG WINAPI _RtlDispatchException( PEXCEPTION_RECORD pExcptRec,CONTEXT * pContext )<br>
{<br>
&nbsp;&nbsp;if(RtlDispatchException(pExcptRec,pContext)) return 1;<br>
&nbsp;&nbsp;return m_fnRtlDispatchException(pExcptRec,pContext);<br>
}<br>
BOOL HookSystemSEH()<br>
{<br>
&nbsp; &nbsp; &nbsp; &nbsp; m_fnRtlDispatchException=(pfnRtlDispatchException)::GetProcAddress(::GetModuleHandleA("ntdll"),"KiUserExceptionDispatcher");<br>
&nbsp; &nbsp; &nbsp; &nbsp; return 0;<br>
//&nbsp; &nbsp; &nbsp; &nbsp; return SetInlineHook((PVOID*)&amp;m_fnRtlDispatchException,_RtlDispatchException);<br>
}<br>
DWORD Address = 0,EndAddress = 0;<br>
LPVOID Data = 0;<br>
DWORD IsCall = 0;<br>
HANDLE VectoredHandler = 0;<br>
VOID WINAPI RegFilter()<br>
{<br>
&nbsp; &nbsp; &nbsp; &nbsp; PVOID Data = (PVOID)Address;<br>
&nbsp; &nbsp; &nbsp; &nbsp; if(RtlNtStatusToDosError==0) exit(0);<br>
#ifndef _DEBUG<br>
&nbsp; &nbsp; &nbsp; &nbsp; if(::IsDebuggerPresent()) return ;<br>
#else<br>
<br>
#endif<br>
&nbsp; &nbsp; &nbsp; &nbsp; VectoredHandler=AddVectoredExceptionHandler(1,MyTopUnhandledExceptionFilter);<br>
&nbsp; &nbsp; &nbsp; &nbsp; if(VectoredHandler==0) exit(0);<br>
}<br>
int WINAPI Show()<br>
{<br>
&nbsp; &nbsp; &nbsp; &nbsp; return ::MessageBox(0,L"我差，居然有调试器，请结束调试器！",L"调试器",16);<br>
}<br>
__declspec(naked)int APIENTRY _tWinMain(HINSTANCE hInstance,<br>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;HINSTANCE hPrevInstance,<br>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;LPTSTR&nbsp; &nbsp; lpCmdLine,<br>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;int&nbsp; &nbsp;&nbsp; &nbsp; nCmdShow)<br>
{<br>
&nbsp; &nbsp; &nbsp; &nbsp; _asm<br>
&nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov edi,edi//WINAPI 约定调用方式 这里的一大堆指令，其实就是一个意思，就是jmp _tWinMain2<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push ebp <br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ebp, esp<br>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;push eax<br>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;lea eax,dword ptr[Error]<br>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;mov Address,eax<br>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;lea eax,dword ptr[End]<br>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;mov EndAddress,eax<br>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;mov eax,110<br>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;xor ebx ,ebx<br>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;pop eax<br>
&nbsp; &nbsp; &nbsp; &nbsp; mov esp,ebp<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pop ebp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;mov eax,110<br>
&nbsp; &nbsp; &nbsp; &nbsp; push eax<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push dword ptr[Next]<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push RegFilter<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret<br>
&nbsp; &nbsp; &nbsp; &nbsp; <br>
Next:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pop eax<br>
&nbsp; &nbsp; &nbsp; &nbsp; Error:&nbsp; &nbsp; &nbsp; &nbsp; _asm idiv ebx <br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call Show<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret 16<br>
End:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #ifdef _DEBUG<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret 16<br>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;#else<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call dword ptr[DebugBreak]<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push Error+2<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #endif<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret 16<br>
&nbsp; &nbsp; &nbsp; &nbsp; }<br>
}<br>
LONG WINAPI MyTopUnhandledExceptionFilter(<br>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;struct _EXCEPTION_POINTERS *ExceptionInfo<br>
)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;{<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;PVECTORED_EXCEPTION_HANDLER Handler=(PVECTORED_EXCEPTION_HANDLER)VectoredHandler;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;return Handler(ExceptionInfo);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;WCHAR Buffer[32]={0};<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;&nbsp;ExceptionCode=RtlNtStatusToDosError(ExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionCode);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp; &nbsp; &nbsp; ExceptionCode=::BaseNtStatusToDosError(ExceptionCode);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //_asm int 3 c0000094<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //wsprintf(Buffer,L"%x",ExceptionCode);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //MessageBox(0,Buffer,L"Text",0);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //if(IsCall==1)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(IsCall==2) return 0;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(ExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionCode==0x80000003)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(ExceptionInfo-&gt;ContextRecord-&gt;Eax==120)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //if(EndAddress==(DWORD)ExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionAddress)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExceptionInfo-&gt;ContextRecord-&gt;Eax=119;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExceptionInfo-&gt;ContextRecord-&gt;Esp=ExceptionInfo-&gt;ContextRecord-&gt;Esp+4;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExceptionInfo-&gt;ContextRecord-&gt;Eip=(DWORD)Data;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return EXCEPTION_CONTINUE_EXECUTION;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return 0;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(ExceptionCode==998)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //if(ExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionAddress==(PVOID)Data)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //if(IsCall==2) return 0;<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(ExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionAddress==Data)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memset(Data,0,16);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; VirtualFree(Data,16,MEM_DECOMMIT);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(ExceptionInfo-&gt;ContextRecord-&gt;Eax==119)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IsCall=2;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExceptionInfo-&gt;ContextRecord-&gt;Eip=(DWORD)_tWinMain2;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return EXCEPTION_CONTINUE_EXECUTION;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(ExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionCode==0xc0000094)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //ExceptionInfo-&gt;ExceptionRecord-&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(ExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionAddress==(PVOID)Address)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(ExceptionInfo-&gt;ContextRecord-&gt;Eax==110)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; { <br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;Data=VirtualAlloc(0,16,MEM_COMMIT, PAGE_READWRITE);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;//::IsDebuggerPresent()<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;BOOL IsDebug= ::IsDebuggerPresent();<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #ifndef _DEBUG<br>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;if(::IsDebuggerPresent()) return ;<br>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;#else<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;IsDebug=FALSE;<br>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;#endif<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;if(IsDebug)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;{<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;#ifndef _DEBUG<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExceptionInfo-&gt;ContextRecord-&gt;Eip=ExceptionInfo-&gt;ContextRecord-&gt;Eip+2;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #else<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;ExceptionInfo-&gt;ContextRecord-&gt;Eip=(DWORD)_tWinMain2;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;#endif<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //return EXCEPTION_CONTINUE_EXECUTION;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;RemoveVectoredExceptionHandler(VectoredHandler);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return EXCEPTION_CONTINUE_EXECUTION;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;}<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;#ifdef _DEBUG<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;ExceptionInfo-&gt;ContextRecord-&gt;Eip=(DWORD)_tWinMain2;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;RemoveVectoredExceptionHandler(VectoredHandler);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;return EXCEPTION_CONTINUE_EXECUTION;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;#endif<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(Data==0)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //exit(0);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExceptionInfo-&gt;ContextRecord-&gt;Eip=ExceptionInfo-&gt;ContextRecord-&gt;Eip+2;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }else<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CONTEXT lpContext={0};<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IsCall=1;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memset(Data,0xcc,16);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExceptionInfo-&gt;ContextRecord-&gt;Eax=120;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExceptionInfo-&gt;ContextRecord-&gt;Eip=EndAddress;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return EXCEPTION_CONTINUE_EXECUTION;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;return 0;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;}<br>
int APIENTRY _tWinMain2(HINSTANCE hInstance,<br>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;HINSTANCE hPrevInstance,<br>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;LPTSTR&nbsp; &nbsp; lpCmdLine,<br>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;int&nbsp; &nbsp;&nbsp; &nbsp; nCmdShow)<br>
{<br>
&nbsp; &nbsp; &nbsp; &nbsp; UNREFERENCED_PARAMETER(hPrevInstance);<br>
&nbsp; &nbsp; &nbsp; &nbsp; UNREFERENCED_PARAMETER(lpCmdLine);<br>
<br>
 &nbsp; &nbsp; &nbsp; &nbsp; // TODO: 在此放置代码。<br>
//&nbsp; &nbsp; &nbsp; &nbsp; _asm int&nbsp;&nbsp;3<br>
&nbsp; &nbsp; &nbsp; &nbsp; MSG msg;<br>
&nbsp; &nbsp; &nbsp; &nbsp; HACCEL hAccelTable;<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; // 初始化全局字符串<br>
&nbsp; &nbsp; &nbsp; &nbsp; LoadString(hInstance, IDS_APP_TITLE, szTitle, MAX_LOADSTRING);<br>
&nbsp; &nbsp; &nbsp; &nbsp; LoadString(hInstance, IDC_SETHARDWARE, szWindowClass, MAX_LOADSTRING);<br>
&nbsp; &nbsp; &nbsp; &nbsp; MyRegisterClass(hInstance);<br>
&nbsp; &nbsp; &nbsp; &nbsp; <br>
&nbsp; &nbsp; &nbsp; &nbsp; // 执行应用程序初始化:<br>
&nbsp; &nbsp; &nbsp; &nbsp; if (!InitInstance (hInstance, nCmdShow))<br>
&nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return FALSE;<br>
&nbsp; &nbsp; &nbsp; &nbsp; }<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; hAccelTable = LoadAccelerators(hInstance, MAKEINTRESOURCE(IDC_SETHARDWARE));<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; // 主消息循环:<br>
&nbsp; &nbsp; &nbsp; &nbsp; while (GetMessage(&amp;msg, NULL, 0, 0))<br>
&nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!TranslateAccelerator(msg.hwnd, hAccelTable, &amp;msg))<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TranslateMessage(&amp;msg);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DispatchMessage(&amp;msg);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; }<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; return (int) msg.wParam;<br>
}<br><br>//<br>
//&nbsp;&nbsp;函数: MyRegisterClass()<br>
//<br>
//&nbsp;&nbsp;目的: 注册窗口类。<br>
//<br>
//&nbsp;&nbsp;注释:<br>
//<br>
//&nbsp; &nbsp; 仅当希望<br>
//&nbsp; &nbsp; 此代码与添加到 Windows 95 中的“RegisterClassEx”<br>
//&nbsp; &nbsp; 函数之前的 Win32 系统兼容时，才需要此函数及其用法。调用此函数十分重要，<br>
//&nbsp; &nbsp; 这样应用程序就可以获得关联的<br>
//&nbsp; &nbsp; “格式正确的”小图标。<br>
//<br>
ATOM MyRegisterClass(HINSTANCE hInstance)<br>
{<br>
&nbsp; &nbsp; &nbsp; &nbsp; WNDCLASSEX wcex;<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; wcex.cbSize = sizeof(WNDCLASSEX);<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; wcex.style&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = CS_HREDRAW | CS_VREDRAW;<br>
&nbsp; &nbsp; &nbsp; &nbsp; wcex.lpfnWndProc&nbsp; &nbsp; &nbsp; &nbsp; = WndProc;<br>
&nbsp; &nbsp; &nbsp; &nbsp; wcex.cbClsExtra&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0;<br>
&nbsp; &nbsp; &nbsp; &nbsp; wcex.cbWndExtra&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0;<br>
&nbsp; &nbsp; &nbsp; &nbsp; wcex.hInstance&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = hInstance;<br>
&nbsp; &nbsp; &nbsp; &nbsp; wcex.hIcon&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = LoadIcon(hInstance, MAKEINTRESOURCE(IDI_SETHARDWARE));<br>
&nbsp; &nbsp; &nbsp; &nbsp; wcex.hCursor&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = LoadCursor(NULL, IDC_ARROW);<br>
&nbsp; &nbsp; &nbsp; &nbsp; wcex.hbrBackground&nbsp; &nbsp; &nbsp; &nbsp; = (HBRUSH)(COLOR_WINDOW+1);<br>
&nbsp; &nbsp; &nbsp; &nbsp; wcex.lpszMenuName&nbsp; &nbsp; &nbsp; &nbsp; = MAKEINTRESOURCE(IDC_SETHARDWARE);<br>
&nbsp; &nbsp; &nbsp; &nbsp; wcex.lpszClassName&nbsp; &nbsp; &nbsp; &nbsp; = szWindowClass;<br>
&nbsp; &nbsp; &nbsp; &nbsp; wcex.hIconSm&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = LoadIcon(wcex.hInstance, MAKEINTRESOURCE(IDI_SMALL));<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; return RegisterClassEx(&amp;wcex);<br>
}<br>
<br>
//<br>
//&nbsp; &nbsp;函数: InitInstance(HINSTANCE, int)<br>
//<br>
//&nbsp; &nbsp;目的: 保存实例句柄并创建主窗口<br>
//<br>
//&nbsp; &nbsp;注释:<br>
//<br>
//&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;在此函数中，我们在全局变量中保存实例句柄并<br>
//&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;创建和显示主程序窗口。<br>
//<br>
BOOL InitInstance(HINSTANCE hInstance, int nCmdShow)<br>
{<br>
&nbsp; &nbsp;HWND hWnd;<br>
<br>
&nbsp; &nbsp;hInst = hInstance; // 将实例句柄存储在全局变量中<br>
<br>
&nbsp; &nbsp;hWnd = CreateWindow(szWindowClass, szTitle, WS_OVERLAPPEDWINDOW,<br>
&nbsp; &nbsp;&nbsp; &nbsp;CW_USEDEFAULT, 0, CW_USEDEFAULT, 0, NULL, NULL, hInstance, NULL);<br>
<br>
&nbsp; &nbsp;if (!hWnd)<br>
&nbsp; &nbsp;{<br>
&nbsp; &nbsp;&nbsp; &nbsp;return FALSE;<br>
&nbsp; &nbsp;}<br>
<br>
&nbsp; &nbsp;ShowWindow(hWnd, nCmdShow);<br>
&nbsp; &nbsp;UpdateWindow(hWnd);<br>
<br>
&nbsp; &nbsp;return TRUE;<br>
}<br>
<br>
//<br>
//&nbsp;&nbsp;函数: WndProc(HWND, UINT, WPARAM, LPARAM)<br>
//<br>
//&nbsp;&nbsp;目的: 处理主窗口的消息。<br>
//<br>
//&nbsp;&nbsp;WM_COMMAND&nbsp; &nbsp; &nbsp; &nbsp; - 处理应用程序菜单<br>
//&nbsp;&nbsp;WM_PAINT&nbsp; &nbsp; &nbsp; &nbsp; - 绘制主窗口<br>
//&nbsp;&nbsp;WM_DESTROY&nbsp; &nbsp; &nbsp; &nbsp; - 发送退出消息并返回<br>
//<br>
//<br>
LRESULT CALLBACK WndProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)<br>
{<br>
&nbsp; &nbsp; &nbsp; &nbsp; int wmId, wmEvent;<br>
&nbsp; &nbsp; &nbsp; &nbsp; PAINTSTRUCT ps;<br>
&nbsp; &nbsp; &nbsp; &nbsp; HDC hdc;<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; switch (message)<br>
&nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; case WM_COMMAND:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wmId&nbsp; &nbsp; = LOWORD(wParam);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wmEvent = HIWORD(wParam);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 分析菜单选择:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; switch (wmId)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case IDM_ABOUT:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DialogBox(hInst, MAKEINTRESOURCE(IDD_ABOUTBOX), hWnd, About);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case IDM_EXIT:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DestroyWindow(hWnd);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return DefWindowProc(hWnd, message, wParam, lParam);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br>
&nbsp; &nbsp; &nbsp; &nbsp; case WM_PAINT:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hdc = BeginPaint(hWnd, &amp;ps);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // TODO: 在此添加任意绘图代码...<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EndPaint(hWnd, &amp;ps);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br>
&nbsp; &nbsp; &nbsp; &nbsp; case WM_DESTROY:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PostQuitMessage(0);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br>
&nbsp; &nbsp; &nbsp; &nbsp; default:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return DefWindowProc(hWnd, message, wParam, lParam);<br>
&nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; return 0;<br>
}<br>
<br>
// “关于”框的消息处理程序。<br>
INT_PTR CALLBACK About(HWND hDlg, UINT message, WPARAM wParam, LPARAM lParam)<br>
{<br>
&nbsp; &nbsp; &nbsp; &nbsp; UNREFERENCED_PARAMETER(lParam);<br>
&nbsp; &nbsp; &nbsp; &nbsp; switch (message)<br>
&nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; case WM_INITDIALOG:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return (INT_PTR)TRUE;<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; case WM_COMMAND:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (LOWORD(wParam) == IDOK || LOWORD(wParam) == IDCANCEL)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EndDialog(hDlg, LOWORD(wParam));<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return (INT_PTR)TRUE;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br>
&nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; return (INT_PTR)FALSE;<br>
}<br>
<br>
实际入口点为_tWinMain2，VC，为我们连接的入口点是_tWinMain，至于为什么入口点是_tWinMain，因为这是一个例子，不用更改mainCRTStartup的，这里做演示就已经够了！																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1410220">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-662999.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/662999.png">
							</a>
							<div>
								<span class="group group-104 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2015-1 <br>
								帖子：28 <br>-->

																<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 3</span>
								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-662999.htm">cyxvc</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-6 07:56</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1410220" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1410220" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1410220" class="text-grey mr-3"><span class="floor">43</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								ok！这个我收藏了<img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/28.gif" width="24" height="24" style="cursor: pointer;"><br>
<br>
十分感谢大神的赐教！<br>
<br>
我还处在学习阶段，勉励！																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1410590">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-545089.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/545089.png">
							</a>
							<div>
								<span class="group group-101 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2012-9 <br>
								帖子：72 <br>-->

								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-545089.htm">cooldogpp</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-8 09:04</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1410590" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1410590" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1410590" class="text-grey mr-3"><span class="floor">44</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								这个 真是不错																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1410679">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-583291.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/583291.png">
							</a>
							<div>
								<span class="group group-101 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2013-5 <br>
								帖子：57 <br>-->

								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-583291.htm">jerryroxet</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-8 16:12</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1410679" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1410679" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1410679" class="text-grey mr-3"><span class="floor">45</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								学习了，支持楼主																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1411117">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-84457.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/avatar.png">
							</a>
							<div>
								<span class="group group-101 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2007-4 <br>
								帖子：12 <br>-->

								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-84457.htm">sbfkpyud</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-11 15:19</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1411117" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1411117" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1411117" class="text-grey mr-3"><span class="floor">46</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								这个版块是不是大牛最多的，怎么发现了N多精华和关注，研究壳的都是大牛啊。膜拜																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1411322">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-461175.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/461175.png">
							</a>
							<div>
								<span class="group group-101 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2011-10 <br>
								帖子：19 <br>-->

								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-461175.htm">zxfpt</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-12 18:17</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1411322" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1411322" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1411322" class="text-grey mr-3"><span class="floor">47</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								太高深了，看不懂，我小菜一个写的程序没人感兴趣unpack																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1411527">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-80466.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/avatar.png">
							</a>
							<div>
								<span class="group group-101 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2007-3 <br>
								帖子：21 <br>-->

								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-80466.htm">inheqqq</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-14 08:34</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1411527" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1411527" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1411527" class="text-grey mr-3"><span class="floor">48</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								楼主写的不错，支持一下																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1411792">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-705202.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/705202.png">
							</a>
							<div>
								<span class="group group-101 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2015-12 <br>
								帖子：20 <br>-->

								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-705202.htm">casc</a>
									</span>
									
									<span class="date text-grey ml-2">2016-1-15 14:22</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1411792" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1411792" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1411792" class="text-grey mr-3"><span class="floor">49</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								楼主大神啊，这个神器能脱阿里加固吗？																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1414271">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-422253.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/422253.png">
							</a>
							<div>
								<span class="group group-101 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2011-4 <br>
								帖子：19 <br>-->

								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-422253.htm">kading</a>
									</span>
									
									<span class="date text-grey ml-2">2016-2-3 14:52</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1414271" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1414271" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1414271" class="text-grey mr-3"><span class="floor">50</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								多谢楼主分享																								
								
							</div>
						</td>
					</tr>
																			
															
					<tr class="post" pid="1417980">
						<td class="vtop td-avatar" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-651430.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/651430.png">
							</a>
							<div>
								<span class="group group-101 mr-1"></span>
							</div>
							<div class="text-grey text-tiny" style="text-align: center; margin-top: -4px; ">
								
								<!--注册：2014-10 <br>
								帖子：59 <br>-->

								
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->
							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-651430.htm">伪装的伤痛</a>
									</span>
									
									<span class="date text-grey ml-2">2016-3-3 14:20</span>
									
								</dt>
								<dd class="text-right text-grey ">
																											
																		<a href="javascript:void(0)" tid="206873" pid="1417980" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																		
									

																	
									

	

																		
									<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="206873" data-pid="1417980" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>

																		<a href="https://bbs.pediy.com/thread-206873-1.htm#1417980" class="text-grey mr-3"><span class="floor">51</span> 楼</a>
																		
								</dd>
							</dl>
							<div class="message mt-1 break-all">
																								我擦，居然有调试器																								
								
							</div>
						</td>
					</tr>
								
										
												<tr class="post">
							<td class="td-avatar" aria-hidden="true">
								<a href="https://bbs.pediy.com/user-749004.htm" aria-hidden="true" tabindex="-1">
									<img class="avatar-3" src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/avatar.png">
								</a>
							</td>
							<td class="p-l-0">
								<form action="https://bbs.pediy.com/post-create-206873-1.htm" method="post" id="quick_reply_form">	
									<input type="hidden" name="doctype" value="1">
									<input type="hidden" name="return_html" value="1">
									<input type="hidden" name="quotepid" value="0">
									<dl class="row small text-muted">
										<dt class="username">xiziyunqi</dt>
										<dd class="text-right text-grey"></dd>
									</dl>
									<div class="message mt-1">
										<fieldset class="form-group mb-0">
											<textarea class="form-control" placeholder="内容" name="message" id="message"></textarea>
										</fieldset>
									</div>
									<div class="text-muted  mt-2 small face_open">
										<dl class="row">
											<dt>
												
												<button type="submit" class="btn btn-sm btn-primary" id="submit" data-loading-text="正在提交...">　回帖　</button>
												
												<span class="emotion ml-3">表情</span>
												<span class="ml-3"><a href="https://bbs.pediy.com/thread-216598.htm" target="_bank" class="text-danger">回帖送雪币</a></span>
											</dt>
											<dd class="text-right vtop">
												
												<a class="icon-mail-forward text-muted" href="https://bbs.pediy.com/post-create-206873.htm" id="advanced_reply"> 高级回复</a>
												
											</dd>
										</dl>
									</div>
								</form>
							</td>
						</tr>
											</tbody>
				</table>
			</div>
		</div>
		
		
				<nav class="text-right"><ul class="pagination my-1 justify-content-center"><li class="page-item active"><a href="https://bbs.pediy.com/thread-206873-1.htm" class="page-link">1</a></li><li class="page-item"><a href="https://bbs.pediy.com/thread-206873-2.htm" class="page-link">2</a></li><li class="page-item"><a href="https://bbs.pediy.com/thread-206873-2.htm" class="page-link">▶</a></li></ul></nav>
				
		
		
				
				
		<a role="button" class="btn btn-secondary btn-block xn-back my-3 mx-auto" style="max-width: 50%;" href="javascript:history.back();">返回</a>
		
		<br>
		<br>
		

		

		</div>

	</main>

	
	<footer id="footer" style="background: #3b4348; color: #9ba4aa; height: auto;">
		<div class="container">
			<div class="row text-muted small my-3 mx-0" id="web_base_company_information">
				<div class="col-md-6">
					©2000-2018 看雪学院 | Based on <a href="http://bbs.xiuno.com/" target="_blank" class="text-muted">Xiuno BBS</a> <br>
					域名：<a href="https://www.yunaq.com/" target="_blank" class="text-muted">加速乐</a> | 
					SSL证书：<a href="https://www.upyun.com/" target="_blank" class="text-muted">又拍云</a> | 
					<a href="http://dun.163.com/?from=kanxue_DDoS_2018&amp;hmsr=kanxue%C2%A0" target="_blank" class="text-muted">安全网易云易盾</a>
					<span class="hidden-sm"> | 公众号：ikanxue</span> 
				</div>
				<div class="col-md-6 text-right d-none d-md-block">
					<a href="https://zhuanlan.kanxue.com/article-56.htm" class="text-muted">联系我们</a> | 
					<a href="https://zhuanlan.kanxue.com/article-1.htm" class="text-muted">企业服务</a> <br>
					Processed: <b>0.036</b>s, SQL: <b>13</b> / 京ICP备10040895号-17
				</div>
			</div>
			<div style="max-height: 100px; overflow-y:auto;">
							</div>
		</div>
	</footer>
	


	<!--[if lt IE 9]>
	<script>window.location = 'browser.htm';</script>
	<![endif]-->


	

	<div class="act_go_top" style="position: fixed; bottom: 80px; right: 10px; width: 70px; height: 70px;">
	<a href="javascript:void(0);" style="width: 70px; height: 70px; display: inline-block;background: url(/view/img/scroll_top.png) no-repeat; _background: url(/view/img/scroll_top.png) no-repeat; outline: none;" title="返回顶部"></a>
	</div>




<script src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/bbs.js"></script>
<script src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/jquery-3.1.0.js"></script>
<script src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/popper.js"></script>
<script src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/bootstrap.js"></script>
<script src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/xiuno.js"></script>
<script src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/bootstrap-plugin.js"></script>
<script src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/async.js"></script>
<script src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/form.js"></script>

<script>
var debug = DEBUG = 0;
var url_rewrite_on = 1;
var forumarr = {
    "20": "『悬赏问答』",
    "32": "『外文翻译』",
    "52": "OllyDbg插件收集区",
    "69": "『经典问答』",
    "122": "CTF2017提交区(隐藏版块)",
    "102": "『科锐培训』",
    "141": "CrackMe存档区",
    "151": "『WEB安全』",
    "152": "学习园地",
    "2": "『论坛版务』",
    "4": "『软件逆向』",
    "53": "IDA Pro插件收集区",
    "76": "1)珠海金山2007逆向分析挑战",
    "99": "《加密与解密(第三版)》",
    "169": "『15PB培训』",
    "125": "奇虎360软件安全大赛答案提交区",
    "150": "『二进制漏洞』",
    "128": "『智能设备』",
    "21": "《软件加密技术内幕》",
    "68": "2)PEDIY Crackme竞",
    "41": "『编程技术』",
    "78": "『申请提交区』",
    "95": "《0day:软件漏洞分析技术》",
    "160": "『麦洛克菲培训』",
    "161": "『Android安全』",
    "162": "『企业SRC』",
    "166": "『iOS安全』",
    "3": "桌面平台",
    "79": "智能设备",
    "88": "『加壳脱壳』",
    "91": "3)看雪论坛2008 Explo",
    "120": "4)腾讯公司2008软件安全竞赛",
    "97": "《Windows编程循序渐进》",
    "158": "移动平台",
    "132": "『密码算法』",
    "123": "《微软.NET程序的加密与解密》",
    "127": "5)奇虎360软件安全比赛",
    "37": "『CrackMe』",
    "140": "6)PEDIY Crackme竞",
    "108": "渗透技术",
    "65": "『图书项目』",
    "163": "《C++反汇编与逆向分析技术》",
    "10": "『资源下载』",
    "116": "看雪CTF",
    "155": "8)腾讯公司2010软件安全竞赛",
    "168": "《Android安全与逆向分析》",
    "157": "9)2011 Exploit M",
    "170": "看雪产品",
    "121": "11）移动安全挑战赛（MSC）",
    "129": "12）2015第2届移动安全挑战",
    "136": "职场生活",
    "47": "『招聘专区』",
    "137": "『职业生涯』",
    "171": "『Pwn』",
    "45": "『茶余饭后』",
    "1": "站务管理"
};
var fid = 88;
var uid = 749004;
var gid = 101;
$('[data-toggle="tooltip"]').tooltip();
$('#search_form > input').on('click', function() {
	return false;
});
</script>

<script src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/bbs(1).js"></script>

<script>
// 版主管理：精华
$('.mod-button button.digest').on('click', function() {
	var modtid = $('input[name="modtid"]').checked();
	if(modtid.length == 0) return $.alert(lang.please_choose_thread);
	var radios = xn.form_radio('digest', {"0": "取消精华", "1": "关注","2": "优秀", "3": "精华"});
	$.confirm("设置主题为精华", function() {
		var tids = xn.implode('_', modtid);
		var digest = $('input[name="digest"]').checked();
		var postdata = {digest: digest};
		$.xpost(xn.url('mod-digest-'+tids), postdata, function(code, message) {
			if(code != 0) return $.alert(message);
			$.alert(message).delay(1000).location('');
		});
	}, {'body': '<p>'+"精华等级"+'：'+radios+'</p>'});
})
</script><script>
function xn_read_unread(tids, tid) {
	
	// 当前时间
	var time = xn.time();
	
	// 多长时间内的主题为最新主题
	var time_range = 86400 * 3;
	
	// 三天内的 tids
	var recent_tids = $.pdata('recent_tids') || {};
	
	// 已读的 tids
	var view_tids = $.pdata('view_tids') || {};
	// 提取列表页的 tid
	function fetch_recent_tids(tids) {
		var changed = false;
		$.each(tids, function(tid, last_date) {
			if(time - last_date < time_range) {
				recent_tids[tid] = last_date;
				changed = true;
			}
		});
		if(changed) $.pdata('recent_tids', recent_tids);
	}
	
	// 清理最近的 tid
	function gc_recent_tids() {
		var changed = false;
		$.each(recent_tids, function(tid, last_date) {
			if(time - last_date > time_range) {
				delete recent_tids[tid];
				changed = true;
			}
		});
		if(changed) $.pdata('recent_tids', recent_tids);
	}
	
	function gc_view_tids() {
		var changed = false;
		$.each(view_tids, function(tid, last_date) {
			if(!recent_tids[tid]) {
				delete view_tids[tid];
				changed = true;
			}
		});
		if(changed) $.pdata('view_tids', view_tids);
	}
	
	function save_view_tid(tid) {
		if(!recent_tids[tid]) return;
		view_tids[tid] = time;
		$.pdata('view_tids', view_tids);
	}
	
	if(tids) {
		fetch_recent_tids(tids);
		gc_recent_tids();
		//gc_view_tids();
	}
	if(tid) save_view_tid(tid);
	
	// 三天内的主题标记为已读
	
	// 遍历主题列表，标记最近的，并且未读的为加粗

	$('tr.thread').each(function() {
		var jthis = $(this);
		var tid = jthis.attr('tid');
		if(recent_tids[tid] && recent_tids[tid] > xn.intval(view_tids[tid])) {
			//jthis.find('div.subject').addClass('font-weight-bold');
			jthis.find('div.subject').append('<span class="icon-new"></span>');
			jthis.find('span.icon-post-grey').removeClass('icon-post-grey').addClass('icon-post-blue');
		}
	});
}

</script>

<script type="text/javascript">
$(function() {
	setTimeout(function() {
		$.require('https://www.google-analytics.com/ga.js', function() {
			try {
				var pageTracker = _gat._getTracker("UA-9784446-1");
				pageTracker._trackPageview();
			} catch (err) {}
		});
	}, 1000);

	setTimeout(function() {
		$(".bbs_home_page_three_col .small_logo").each(function(index, element) {

			if ($(element).children("a").length == 0) {
				$(".bbs_home_page_three_col .bbs_home_page_row_div").eq(index).children('div:first-child').removeClass("col-lg-8").addClass("col-lg-9");
				$(".bbs_home_page_three_col .bbs_home_page_row_div").eq(index).children('div:last-child').removeClass("col-lg-4").addClass("col-lg-3");
				$(".bbs_home_page_three_col .bbs_home_page_row_div").eq(index).children('div:first-child').children("span").css("width", "19rem");
			}
		})
	}, 2000);


	if (self != top) {
		$('#header').hide();
		$('#nav2').hide();
		$('#footer').hide();
	}
	// 返回顶部
	$(window).scroll(function() {
		if ($(window).scrollTop() >= 500) {
			$('.act_go_top').fadeIn(300);
		} else {
			$('.act_go_top').fadeOut(300);
		}
	});

	$('.act_go_top').click(function() {
		$('html,body').animate({
			scrollTop: '0px'
		}, 100);
	});

});


</script>

<script>
(function() {
	var islogin = '749004';
	if(islogin == 0)  return; 
	var pm_number = "//www.kanxue.com/pm-new.htm";
	$.xget(pm_number, function(code, message) {
		var pm_number = $(".pm_number");
		var sysm_number = $(".system_message_number");
		if (code == 0) {
			var newpms = parseInt(message.newpms);
			var system_pms = parseInt(message.system_pms);
			var pm_total = newpms + system_pms;
			if (pm_total != 0) {
				pm_total = pm_total > 99 ? "99+" : pm_total;
				$(".pm_total").html(pm_total);
				$(".pm_total").css({
					"display": "inline-block",
					"padding": "0px 7px",
					"font-size": "12px",
					"line-height": "20px",
					"color": "white",
					"background-color": "#f57e42",
					"border-radius": "9px",
					"text-indent": "0px"
				});

				if (system_pms > 0 && newpms == 0) {
					var href = "//www.kanxue.com/pm-system_read-1.htm";
					$(".pm_total_a").attr("href", href);
				}

			} else {
				// $(".pm_total_a").css("display","none");
			};
			if (message.newpms != 0) {
				pm_number.html(message.newpms);
				pm_number.addClass("pmmessage_number");
			} else {
				pm_number.css("display", "none");
			};
			if (message.system_pms != 0) {
				sysm_number.html(message.system_pms);
				sysm_number.addClass("pmmessage_number");
			} else {
				sysm_number.css("display", "none");
			};
			if (message.newpms != 0) {
				pm_number.html(message.newpms);
				pm_number.addClass("pm_numbers_");
			} else {
				pm_number.css("display", "none");
			};
			if (message.system_pms != 0) {
				sysm_number.html(message.system_pms);
				sysm_number.addClass("pm_numbers_");
			} else {
				sysm_number.css("display", "none");
			};


		} else {
			$(".pm_total").css({
				"display": "inline-block",
				"padding": "0px 3px",
				"font-size": "12px",
				"line-height": "20px",
				"color": "white",
				"background-color": "#f57e42",
				"border-radius": "9px",
				"text-indent": "0px"
			});
			pm_number.css("display", "none");
			sysm_number.css("display", "none");

		}
	})

})(jQuery);
</script>

<script>

var forumlist = [
    {
        "fid": "20",
        "fup": "152",
        "name": "『悬赏问答』",
        "rank": "29"
    },
    {
        "fid": "29",
        "fup": "2",
        "name": "『论坛管理团队』",
        "rank": "29"
    },
    {
        "fid": "32",
        "fup": "152",
        "name": "『外文翻译』",
        "rank": "29"
    },
    {
        "fid": "52",
        "fup": "10",
        "name": "OllyDbg插件收集区",
        "rank": "29"
    },
    {
        "fid": "69",
        "fup": "20",
        "name": "『经典问答』",
        "rank": "29"
    },
    {
        "fid": "122",
        "fup": "37",
        "name": "CTF2017提交区(隐藏版块)",
        "rank": "29"
    },
    {
        "fid": "102",
        "fup": "137",
        "name": "『科锐培训』",
        "rank": "29"
    },
    {
        "fid": "141",
        "fup": "140",
        "name": "CrackMe存档区",
        "rank": "29"
    },
    {
        "fid": "151",
        "fup": "108",
        "name": "『WEB安全』",
        "rank": "29"
    },
    {
        "fid": "152",
        "fup": "0",
        "name": "学习园地",
        "rank": "29"
    },
    {
        "fid": "2",
        "fup": "1",
        "name": "『论坛版务』",
        "rank": "28"
    },
    {
        "fid": "4",
        "fup": "3",
        "name": "『软件逆向』",
        "rank": "28"
    },
    {
        "fid": "53",
        "fup": "10",
        "name": "IDA Pro插件收集区",
        "rank": "28"
    },
    {
        "fid": "76",
        "fup": "37",
        "name": "1)珠海金山2007逆向分析挑战",
        "rank": "28"
    },
    {
        "fid": "99",
        "fup": "65",
        "name": "《加密与解密(第三版)》",
        "rank": "28"
    },
    {
        "fid": "169",
        "fup": "137",
        "name": "『15PB培训』",
        "rank": "28"
    },
    {
        "fid": "125",
        "fup": "127",
        "name": "奇虎360软件安全大赛答案提交区",
        "rank": "28"
    },
    {
        "fid": "150",
        "fup": "108",
        "name": "『二进制漏洞』",
        "rank": "28"
    },
    {
        "fid": "128",
        "fup": "79",
        "name": "『智能设备』",
        "rank": "27"
    },
    {
        "fid": "21",
        "fup": "65",
        "name": "《软件加密技术内幕》",
        "rank": "27"
    },
    {
        "fid": "68",
        "fup": "37",
        "name": "2)PEDIY Crackme竞",
        "rank": "27"
    },
    {
        "fid": "41",
        "fup": "3",
        "name": "『编程技术』",
        "rank": "27"
    },
    {
        "fid": "78",
        "fup": "2",
        "name": "『申请提交区』",
        "rank": "27"
    },
    {
        "fid": "95",
        "fup": "65",
        "name": "《0day:软件漏洞分析技术》",
        "rank": "27"
    },
    {
        "fid": "160",
        "fup": "137",
        "name": "『麦洛克菲培训』",
        "rank": "27"
    },
    {
        "fid": "161",
        "fup": "158",
        "name": "『Android安全』",
        "rank": "27"
    },
    {
        "fid": "162",
        "fup": "170",
        "name": "『企业SRC』",
        "rank": "27"
    },
    {
        "fid": "166",
        "fup": "158",
        "name": "『iOS安全』",
        "rank": "27"
    },
    {
        "fid": "3",
        "fup": "0",
        "name": "桌面平台",
        "rank": "26"
    },
    {
        "fid": "79",
        "fup": "0",
        "name": "智能设备",
        "rank": "26"
    },
    {
        "fid": "88",
        "fup": "3",
        "name": "『加壳脱壳』",
        "rank": "26"
    },
    {
        "fid": "91",
        "fup": "37",
        "name": "3)看雪论坛2008 Explo",
        "rank": "26"
    },
    {
        "fid": "120",
        "fup": "37",
        "name": "4)腾讯公司2008软件安全竞赛",
        "rank": "25"
    },
    {
        "fid": "57",
        "fup": "2",
        "name": "『回收站』",
        "rank": "25"
    },
    {
        "fid": "97",
        "fup": "65",
        "name": "《Windows编程循序渐进》",
        "rank": "25"
    },
    {
        "fid": "158",
        "fup": "0",
        "name": "移动平台",
        "rank": "25"
    },
    {
        "fid": "132",
        "fup": "3",
        "name": "『密码算法』",
        "rank": "24"
    },
    {
        "fid": "123",
        "fup": "65",
        "name": "《微软.NET程序的加密与解密》",
        "rank": "24"
    },
    {
        "fid": "127",
        "fup": "37",
        "name": "5)奇虎360软件安全比赛",
        "rank": "24"
    },
    {
        "fid": "37",
        "fup": "116",
        "name": "『CrackMe』",
        "rank": "23"
    },
    {
        "fid": "140",
        "fup": "37",
        "name": "6)PEDIY Crackme竞",
        "rank": "23"
    },
    {
        "fid": "108",
        "fup": "0",
        "name": "渗透技术",
        "rank": "22"
    },
    {
        "fid": "65",
        "fup": "170",
        "name": "『图书项目』",
        "rank": "22"
    },
    {
        "fid": "163",
        "fup": "65",
        "name": "《C++反汇编与逆向分析技术》",
        "rank": "22"
    },
    {
        "fid": "10",
        "fup": "3",
        "name": "『资源下载』",
        "rank": "21"
    },
    {
        "fid": "116",
        "fup": "0",
        "name": "看雪CTF",
        "rank": "21"
    },
    {
        "fid": "155",
        "fup": "37",
        "name": "8)腾讯公司2010软件安全竞赛",
        "rank": "21"
    },
    {
        "fid": "168",
        "fup": "65",
        "name": "《Android安全与逆向分析》",
        "rank": "21"
    },
    {
        "fid": "157",
        "fup": "37",
        "name": "9)2011 Exploit M",
        "rank": "20"
    },
    {
        "fid": "170",
        "fup": "0",
        "name": "看雪产品",
        "rank": "20"
    },
    {
        "fid": "121",
        "fup": "37",
        "name": "11）移动安全挑战赛（MSC）",
        "rank": "18"
    },
    {
        "fid": "129",
        "fup": "37",
        "name": "12）2015第2届移动安全挑战",
        "rank": "17"
    },
    {
        "fid": "136",
        "fup": "0",
        "name": "职场生活",
        "rank": "12"
    },
    {
        "fid": "47",
        "fup": "136",
        "name": "『招聘专区』",
        "rank": "4"
    },
    {
        "fid": "137",
        "fup": "136",
        "name": "『职业生涯』",
        "rank": "3"
    },
    {
        "fid": "171",
        "fup": "116",
        "name": "『Pwn』",
        "rank": "2"
    },
    {
        "fid": "45",
        "fup": "136",
        "name": "『茶余饭后』",
        "rank": "2"
    },
    {
        "fid": "64",
        "fup": "136",
        "name": "『会员专区』",
        "rank": "1"
    },
    {
        "fid": "1",
        "fup": "0",
        "name": "站务管理",
        "rank": "0"
    }
];

// 三级版块
function forum_tree(forumlist, template) {
	var template = template || '<option value="{fid}">{tab}{name}</option>'+"\r\n";
	var s = '';
	var forumlist1 = forumlist.filter(function(v) {return v.fup == 0});
	for(var i1=0; i1<forumlist1.length; i1++) {
		var v1 = forumlist1[i1];
		s += '►'+xn.template(template, {fid: v1.fid, name: v1.name, tab: "　"});
		var forumlist2 = forumlist.filter(function(v2) {return v2.fup == v1.fid});
		for(var i2=0; i2<forumlist2.length; i2++) {
			var v2 = forumlist2[i2];
			s += xn.template(template, {fid: v2.fid, name: v2.name, tab: "　　"});
			var forumlist3 = forumlist.filter(function(v3) {return v3.fup == v2.fid});
			for(var i3=0; i3<forumlist3.length; i3++) {
				var v3 = forumlist3[i3];
				s += xn.template(template, {fid: v3.fid, name: v3.name, tab: "　　　　"});
			}

		}
	}
	return s;
}


// 版主管理：移动 / moderator : move
$('.mod-button button.move').off('click').on('click', function() {
	var modtid = $('input[name="modtid"]').checked();
	if(modtid.length == 0) return $.alert(lang.please_choose_thread);
	var select = '<select name="fid">'+forum_tree(forumlist)+'</select>';
	$.confirm(lang.move_forum, function() {
		var tids = xn.implode('_', modtid);
		var newfid = $('select[name="fid"]').val();
		$.xpost(xn.url('mod-move-'+tids+'-'+newfid), function(code, message) {
			if(code != 0) return $.alert(message);
			$.alert(message).delay(1000).location('');
		});
	}, {'body': '<p>'+lang.choose_move_forum+'：'+select+'</p>'});
})

</script><script>

// 版主管理：审核
$('.mod-button button.audit').on('click', function() {
	var modtid = $('input[name="modtid"]').checked();
	if(modtid.length == 0) return $.alert(lang.please_choose_thread);
	var radios = xn.form_radio('audit', {"1": "审核通过", "2": "审核不通过"});
	$.confirm('审核主题', function() {
		var tids = xn.implode('_', modtid);
		var audit = $('input[name="audit"]').checked();
		var postdata = {audit: audit};
		$.xpost(xn.url('mod-audit-'+tids), postdata, function(code, message) {
			if(code != 0) return $.alert(message);
			$.alert(message).delay(1000).location('');
		});
	}, {'body': '<p>'+'审核选项'+'：'+radios+'</p>'});
})

</script>
<script>

$(function() {
	// 版主管理：删除 / moderator : delete
	$('.mod-button button.delete').off('click').on('click', function() {
		var modtid = $('input[name="modtid"]').checked();
		if(modtid.length == 0) return $.alert(lang.please_choose_thread);
		var radios = '';
				//var htmladd = '<br><br><label class="text-small"><input type="checkbox" name="logic" value="0" /> 物理删除</label>';
		//htmladd += '<br><label class="text-small"><input type="checkbox" name="logic" value="0" /> 恢复删除</label>';
		$.confirm(xn.lang('confirm_delete_thread', {n:modtid.length}) + '<br><br>'+radios, function() {
			var tids = xn.implode('_', modtid);
			var type = $('input[name="type"]').checked();
			$.xpost(xn.url('mod-delete-'+tids), {type: type}, function(code, message) {
				if(code != 0) return $.alert(message);
				$.alert(message).delay(1000).location('');
			});
		});
	})

	// 恢复逻辑删除的帖子
	$('body').on('click', '.post_recover', function() {
		var jthis = $(this);
		var href = jthis.data('href');
		var isfirst = jthis.attr('isfirst');
		if(window.confirm('确定恢复删除的帖子？')) {
			$.xpost(href, function(code, message) {
				var isfirst = jthis.attr('isfirst');
				if(code == 0) {
					if(isfirst == '1') {
						$.location('forum-88.htm');
					} else {
						window.location.reload();
					}
				} else {
					$.alert(message);
				}
			});
		}
		return false;
	});

})

</script>

<div class="modal fade appeal" id="appeal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
                <div class="modal-content">
                        <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">×</span>
                        </button>
                        <h4 class="modal-title" id="exampleModalLabel">求助问答申诉</h4>
                        </div>
                        <form id="form_appeal" action="https://bbs.pediy.com/post-appeal.htm" method="post">
	                        <div class="modal-body">
	                                <div class="form-group">
	                                	<input id="pid" name="pid" value="0" type="hidden">
	                                        <textarea class="form-control" id="brief" name="brief" rows="6" placeholder="请填写内容，注意: 请写明申诉的原因"></textarea>
	                                </div>
	                        </div>
	                        <div class="modal-footer">
	                                <button id="appeal_submit" type="button" class="btn btn-primary" data-loading-text="正在提交...">申请提交</button>
	                        </div>
	                </form>
                </div>
        </div>
</div><div class="modal fade report" id="report" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
                <div class="modal-content">
                        <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">×</span>
                        </button>
                        <h4 class="modal-title" id="exampleModalLabel">举报此帖</h4>
                        </div>
                        <form id="form_report" action="https://bbs.pediy.com/post-report.htm" method="post">
                                <div class="modal-body">
                                        <div class="form-group">
                                                <input id="tid" name="tid" value="0" type="hidden">
                                                <input id="pid" name="pid" value="0" type="hidden">
                                                <textarea class="form-control" id="brief" name="brief" rows="6" placeholder="请填写内容，注意: 请确认您所举报此帖的内容涉及到语言挑衅和违犯论坛版规的内容， 版主将收到举报后审核该帖！"></textarea>
                                        </div>
                                </div>
                                <div class="modal-footer">
                                        <button id="report_submit" type="button" class="btn btn-primary" data-loading-text="正在提交...">发送报告</button>
                                </div>
                        </form>
                </div>
        </div>
</div>

<script src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/face.js"></script>

<script>
$(function() {
	var jform = $('#quick_reply_form');
	var jsubmit = $('#submit');
	jform.on('submit', function() {
		jform.reset();
		jsubmit.button('loading');
		var postdata = jform.serialize();
		$.xpost(jform.attr('action'), postdata, function(code, message) {
			if (code == 0) {
				var s = '<table>' + message + '</table>';
				var jtr = $(s).find('tr');
				jtr.insertBefore($('table.postlist tr').last());
				jsubmit.button('reset');
				$('#message').val('');

				// 楼层 +1
				var jfloor = jform.find('.floor');
				jfloor.html(xn.intval(jfloor.html()) + 1);

				// 回复数 +1
				var jposts = $('.posts');
				jposts.html(xn.intval(jposts.html()) + 1);

			} else if (code < 0) {
				$.alert(message);
				jsubmit.button('reset');
			} else {
				jform.find('[name="' + code + '"]').alert(message).focus();
				jsubmit.button('reset');
			}
		});
		return false;
	});


	//收藏功能
	var jfavorite = $('#favorite');
	var jlikes = $('#likes');
   
	jfavorite.on('click', function() {
		var likenum = jlikes.text();
		likenum_plus = parseInt(likenum) + 1;
		likenum_sub = parseInt(likenum) - 1;
		if(likenum_sub < 0) likenum_sub = 0;
		$.xpost('thread-favorite-206873.htm', function(code, message) {
			if(code == 0) {
				var s = '<a href="javascript:void(0)" title="取消收藏"><i class="icon-star"></i>&nbsp;已收藏</a>';
				jfavorite.html(s);
				jlikes.text(likenum_plus);

			}else if(code == 1) {
				var s = '<a href="javascript:void(0)" title="点我收藏"><i class="icon-star-o"></i>&nbsp;收藏</a>';
				jfavorite.html(s);
				jlikes.text(likenum_sub);
			} else {
				$.alert(message);
			}
		});
		return false;
	});
	// 缩放图片，适应屏幕大小。
	function resize_image() {
		var jmessagelist = $('div.message');
		var first_width = jmessagelist.width(); // 815 : 746; //  734 746
		jmessagelist.each(function() {
			var jdiv = $(this);
			var maxwidth = jdiv.attr('isfirst') ? first_width : first_width - 79; //  734 746
			var jmessage_width = Math.min(jdiv.width(), maxwidth);
			jdiv.find('img, embed, iframe').each(function() {
				var jimg = $(this);
				//if(jimg.width() < 500) return;
				var img_width = this.org_width;
				var img_height = this.org_height;
				if (!img_width) {
					var img_width = jimg.width();
					var img_height = jimg.height();
					this.org_width = img_width;
					this.org_height = img_height;
				}
				//var percent = xn.min(100, xn.ceil((img_width / jmessage_width) * 100));
				if (img_width > jmessage_width) {
					if (this.tagName == 'IMG') {
						jimg.width(jmessage_width);
						jimg.css('height', 'auto');
					} else {
						jimg.width(jmessage_width);
						var height = (img_height / img_width) * jimg.width();
						jimg.height(height);
					}
				}

			});
			
			jdiv.find('p').each(function() {
				var jp = $(this);
				if($.trim(jp.text()) == '') {
					jp.css('line-height', '1');
				}
			});
		});
	}
	resize_image();
	$(window).on('resize', resize_image);
 	//---------by wang start------------------------//
	//取出tr的pid，赋值给tr使name为point_pid
	// $(".post").each(function() {
	// 	var cpid = $(this).attr("pid");
	// 	$(this).attr("id","point_"+ cpid);
	// });
	var url = window.location.toString();
	
	if(url.indexOf("#") != -1){
		var cpid = url.split("#")[1];
		if(cpid) {
			$(".post").each(function(k,v) {
				if($(v).attr("pid") == cpid) {
					var t = $(this).offset() ? $(this).offset().top : 0;
					//$("#frame_right").scrollTop(t);
					$("html,body").animate({scrollTop:t},800)
				}
				
			});
			
		}
	}
	
	//------------by wang end----------------------------//


	
	// 输入框自动伸缩
	var jmessage = $('#message');
	jmessage.on('focus', function() {
		if (jmessage.t) {
			clearTimeout(jmessage.t);
			jmessage.t = null;
		}
		jmessage.css('height', '6rem');
	});
	jmessage.on('blur', function() {
		jmessage.t = setTimeout(function() {
			jmessage.css('height', '2.5rem');
		}, 1000);
	});

	$('#nav_pc li[fid="88"]').addClass('active');
	$('#nav_mobile li[fid="88"]').addClass('active');

	 $(function(){
		$('.emotion').qqFace({
			id : 'facebox',
			assign:'message',
			path:'view/img/face/'
		});
	});

	$("div.message img").css("cursor","pointer");
	$("div.message img").on("click",function() {
		if (window.innerWidth > 768) {
			var img_src = $(this).attr("src");
			window.open(img_src);
		}
	})
	setTimeout(function() {
		$("div.message img").each(function(index, element) {
			if ($(element).width() >= 100) {
				$(element).addClass("div_message_boxShadow");
			}
		})
	}, 2000);
});
</script>

<script>
var jpay_form = $('#pay_kx');
var jkxpay = $('.kx-pay');
var rid = 0;
var check_handle = null;

function topay(){
    clearInterval(check_handle);
    check_handle = null;
    var valtype = $("input[name='reward_type']:checked").val();
    var rmbstype = $("input[name='reward_rmbs']:checked").val();
    if(!valtype) { alert('请您选择一个支付方式!'); return false; }
    if(rmbstype < 1){
        alert("好扣哦，打赏金额不能少于1元");
        return false;
    }else if(valtype == 1){
        if(_is_weixin) {
            $.alert('请用其它浏览器打开再用赞赏功能!');
            return false;
        }
        window.Popup = window.open('about:blank', '_blank','width='+window.screen.width+',height='+window.screen.height+', ...');
        var ptdata = jpay_form.serialize();
        jkxpay.button('loading');
        $.xpost('reward_pay-charge.htm', ptdata, function(code, message) {
            if(code == 0) {
                Popup.blur();
                Popup.opener.focus();
                Popup.location = 'reward_pay-reward_alipay-'+ message +'.htm';
                jkxpay.button('reset');
                $('.reward').modal('hide');
                check_setInterval(message);
            } else if(code < 0) {
                Popup.close();
                alert(message);
                jkxpay.button('reset');
            } else {
                Popup.close();
                alert(message);
                jkxpay.button('reset');
            }
        });
        return false;
    }else if(valtype == 2){
        var postdata = jpay_form.serialize();
        jkxpay.button('loading');
        $.xpost('reward_pay-reward_remainder.htm', postdata, function(code, message) {
            if(code == 0) {
                $.alert(message);
                jkxpay.button('reset');
                $('.reward').modal('hide');
                window.location.reload();
            } else if(code < 0) {
               $.alert(message);
                jkxpay.button('reset');
            } else {
                $.alert(message);
                jkxpay.button('reset');
            }
        });
        return false;
    }else{
        $('.reward').modal('hide');
        return false;
    }
}

function check_status(rid) {
  $.xpost('reward_pay-check.htm', {checkid: rid}, function(code, message) {
    if(code == 0) {
      Popup.close();
      $.alert('恭喜您，赞赏成功！');
      setTimeout(function() {
                 window.location.reload();
      }, 3000);
      // if(check_handle) {
        clearInterval(check_handle);
        check_handle = null;
      // }
    } else {
      return false;
    }
  });
}

function check_setInterval(rid) {
  check_handle = setInterval(function() {
    check_status(rid);
  }, 3000);
}

window._is_weixin = function() {
  var _ua = window.navigator.userAgent.toLowerCase();
  if (_ua.match(/MicroMessenger/i) == 'micromessenger') {
      return true;
  } else {
      return false;
  }
}()

</script><script>
var jform_appeal = $('#form_appeal');
var appeal_submit = $('#appeal_submit');

appeal_submit.on('click', function() {
    jform_appeal.reset();
    appeal_submit.button('loading');
    var postdata = jform_appeal.serialize();
    
    $.xpost(jform_appeal.attr('action'), postdata, function(code, message) {
        if(code == 0) {
       	$.alert(message);
       	appeal_submit.button('reset');
       	setTimeout(function(){window.location.reload();
            }, 2000);
        } else {
    	$.alert(message);
    	appeal_submit.button('reset');
        }
    });
    return false;
});

 $('#appeal').on('show.bs.modal', function (event) {
	var button = $(event.relatedTarget)
	var pid = button.data('pid');
	var modal = $(this);
	modal.find('.modal-body #pid').val(pid);

})
</script><script>

var jform_report = $('#form_report');
var report_submit = $('#report_submit');

report_submit.on('click', function() {
    jform_report.reset();
    report_submit.button('loading');
    var postdata = jform_report.serialize();
    
    $.xpost(jform_report.attr('action'), postdata, function(code, message) {
        if(code == 0) {
       	$.alert(message);
       	report_submit.button('reset');
       	setTimeout(function(){window.location.reload();
            }, 1000);
        } else {
    	$.alert(message);
    	report_submit.button('reset');
        }
    });
    return false;
});

$('#report').on('show.bs.modal', function (event) {
	var button = $(event.relatedTarget)
    var tid = button.data('tid');
    var pid = button.data('pid');
    var modal = $(this);

    modal.find('.modal-body #tid').val(tid);
    modal.find('.modal-body #pid').val(pid);
})

</script><!--游客下载附件关注微信公众号-->
<div class="modal fade download_code" id="download_code" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm" role="document">
                <div class="modal-content">
                        <div class="modal-header">
	                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	                                <span aria-hidden="true">×</span>
	                        </button>
	                        <h5 class="modal-title" id="exampleModalLabel">游客下载提示</h5>
                        </div>
                        <form id="form_download" action="https://bbs.pediy.com/thread-206873.htm" method="post" target="_blank">
                                <div class="modal-body text-center">
                                    <input id="aid" name="aid" value="0" type="hidden">
                                    <dl class="row">
                                    	<dd class="text-left" style="width:50%">
                                        	<div style="font-size:14px">
                                        		<div>1.请先关注公众号。</div>
                                        		<div>2.点击菜单"更多"。</div>
                                        		<div>3.选择获取下载码。</div>
                                        	</div>
                                    	</dd>
                                    	<dt><img src="./[原创][开源]用C++实现的壳(扩展版)-『加壳脱壳』-看雪安全论坛_files/wxgz.jpg" width="80%"></dt>
                                    </dl>
                                    <fieldset class="form-group">
                						<input class="form-control" type="text" id="download_code" name="download_code" placeholder="请输入下载码" value="">
                					</fieldset>
                                </div>
                                <div class="modal-footer">
                                        <button id="download_submit" type="button" class="btn btn-primary" data-loading-text="正在提交...">下载</button>
                                </div>
                        </form>
                </div>
        </div>
</div>

<script>

var jform_download = $('#form_download');
var jdownload_submit = $('#download_submit');

jdownload_submit.on('click', function() {
    jform_download.reset();
    jdownload_submit.button('loading');
    var postdata = jform_download.serialize();

    var aid2 = jform_download.find('.modal-body #aid').val();
    
    $.xpost(jform_download.attr('action'), postdata, function(code, message) {
        if(code == 0) {
	       	jdownload_submit.button('下载中...');
	       	var href = "attach-download-"+aid2+"-"+message+".htm";
		window.location = href;
		setTimeout(function() {
                    jdownload_submit.button('reset');
                    jform_download.find('.modal-body #download_code').val('');
                }, 1500);
		
        } else {
	    	$.alert(message);
	    	jdownload_submit.button('reset');
        }
    });
    return false;
});

$('#download_code').on('show.bs.modal', function (event) {
    var button = $(event.relatedTarget)
    var aid = button.data('aid');
    var modal = $(this);
    var down_action="attach-download_code-"+aid+".htm";

    modal.find('.modal-body #aid').val(aid);
    modal.find('#form_download').attr('action', down_action);
})

</script><script>
xn_read_unread({"206873": "1506503415"}, 206873);
</script><script>
jsearch_form = $('#search_form');
jsearch_form.on('submit', function() {
	var keyword = jsearch_form.find('input[name="keyword"]').val();
	var url = xn.url('search-'+xn.urlencode(keyword));
	window.location = url;
	return false;
});
</script><script>
// 语法高亮
if($('div.message pre').length > 0) {
	$.require_css('plugin/xn_syntax_hightlighter/syntax_hightlighter/syntax.css');
	$.require('plugin/xn_syntax_hightlighter/syntax_hightlighter/syntax.js', function() {
		SyntaxHighlighter.all();
	});
}
</script></body></html>